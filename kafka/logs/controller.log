[2025-01-13 22:50:31,725] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-13 22:50:31,750] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2025-01-13 22:50:31,755] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2025-01-13 22:50:31,791] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-13 22:50:31,794] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-13 22:50:31,798] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-13 22:50:31,799] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-13 22:50:31,810] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2025-01-13 22:50:31,814] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-13 22:50:31,818] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-13 22:50:31,824] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-13 22:50:31,824] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-13 22:50:31,825] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-13 22:50:31,825] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-13 22:50:31,825] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-13 22:50:31,827] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-13 22:50:31,827] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-13 22:50:31,827] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-13 22:50:31,828] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-13 22:50:31,829] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-13 22:50:31,837] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 22:50:31,838] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 22:50:31,844] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 22:50:31,845] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 22:50:31,845] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-13 22:50:31,846] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-13 22:50:31,852] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-01-13 22:50:31,853] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2025-01-13 22:50:31,859] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-13 22:50:31,860] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-13 22:50:31,860] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-13 22:50:31,860] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-13 22:50:31,862] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-13 22:50:31,880] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-13 22:50:32,354] INFO [RequestSendThread controllerId=0] Controller 0 connected to DESKTOP-JN5NMG8:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-13 22:50:36,896] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 22:50:36,897] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 22:52:07,878] INFO [Controller id=0] New topics: [Set(myFirstTopic)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(myFirstTopic,Some(TezPFIffS9qkUbxgC3Bf9g),Map(myFirstTopic-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-13 22:52:07,879] INFO [Controller id=0] New partition creation callback for myFirstTopic-0 (kafka.controller.KafkaController)
[2025-01-13 22:52:25,659] DEBUG [Controller id=0] There is no producerId block yet (Zk path version 0), creating the first block (kafka.controller.KafkaController)
[2025-01-13 22:52:25,665] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000) by writing to Zk with path version 1 (kafka.controller.KafkaController)
[2025-01-13 22:53:06,774] INFO [Controller id=0] New topics: [Set(__consumer_offsets)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(__consumer_offsets,Some(sNjT4SmtRya--5awG4xgjA),HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-13 22:53:06,775] INFO [Controller id=0] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2025-01-13 22:55:36,909] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 22:55:36,909] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 22:55:36,915] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-13 22:55:36,918] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-13 23:00:36,927] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 23:00:36,932] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 23:00:36,937] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-13 23:00:36,937] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-13 23:01:20,025] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-13 23:01:20,025] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-13 23:01:20,026] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-13 23:01:20,029] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),myFirstTopic-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-13 23:01:20,211] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-13 23:01:20,211] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-13 23:01:20,211] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-13 23:01:20,211] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-13 23:01:20,212] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-13 23:01:20,212] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-13 23:01:20,212] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 23:01:20,213] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-13 23:01:20,213] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-13 23:01:20,213] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-13 23:01:20,214] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-13 23:30:01,560] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-13 23:30:01,581] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2025-01-13 23:30:01,583] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-13 23:30:01,586] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-13 23:30:01,588] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-13 23:30:01,590] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-13 23:30:01,606] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 157) (kafka.controller.KafkaController)
[2025-01-13 23:30:01,619] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-13 23:30:01,646] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-13 23:30:01,653] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-13 23:30:01,659] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-13 23:30:01,660] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-13 23:30:01,660] INFO [Controller id=0] Current list of topics in the cluster: HashSet(myFirstTopic, __consumer_offsets) (kafka.controller.KafkaController)
[2025-01-13 23:30:01,660] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-13 23:30:01,691] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-13 23:30:01,692] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-13 23:30:01,692] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-13 23:30:01,692] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-13 23:30:01,693] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-13 23:30:01,702] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 23:30:01,707] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 23:30:01,732] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 23:30:01,732] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=myFirstTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-13 23:30:01,732] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-13 23:30:01,737] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-13 23:30:01,738] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, myFirstTopic-0 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-13 23:30:01,739] INFO [Controller id=0] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2025-01-13 23:30:01,742] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-13 23:30:01,743] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-13 23:30:01,743] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-13 23:30:01,743] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-13 23:30:01,744] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-13 23:30:01,754] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-13 23:30:02,208] INFO [RequestSendThread controllerId=0] Controller 0 connected to DESKTOP-JN5NMG8:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-13 23:30:06,768] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 23:30:06,769] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 23:30:06,779] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-13 23:30:06,780] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-13 23:31:40,946] DEBUG [Controller id=0] Read current producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000), Zk path version 1 (kafka.controller.KafkaController)
[2025-01-13 23:31:40,951] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=1000, size=1000) by writing to Zk with path version 2 (kafka.controller.KafkaController)
[2025-01-13 23:35:06,789] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 23:35:06,789] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 23:35:06,790] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-13 23:35:06,791] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-13 23:40:06,801] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 23:40:06,801] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 23:40:06,804] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-13 23:40:06,804] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-13 23:45:06,813] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 23:45:06,813] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 23:45:06,816] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-13 23:45:06,816] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-13 23:50:06,823] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 23:50:06,823] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 23:50:06,825] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-13 23:50:06,826] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-13 23:55:06,839] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-13 23:55:06,839] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-13 23:55:06,841] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-13 23:55:06,841] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:00:06,853] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:00:06,857] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:00:06,859] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:00:06,859] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:05:06,869] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:05:06,869] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:05:06,871] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:05:06,871] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:10:06,877] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:10:06,877] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:10:06,878] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:10:06,878] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:15:06,884] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:15:06,884] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:15:06,886] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:15:06,886] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:20:06,889] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:20:06,889] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:20:06,891] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:20:06,891] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:25:06,905] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:25:06,905] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:25:06,905] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:25:06,905] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:30:06,920] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:30:06,920] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:30:06,920] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:30:06,920] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:35:06,933] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:35:06,933] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:35:06,933] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:35:06,933] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:40:06,936] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:40:06,936] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:40:06,937] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:40:06,937] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:45:06,943] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:45:06,943] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:45:06,944] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:45:06,944] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:50:06,957] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:50:06,957] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:50:06,957] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:50:06,957] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 00:55:06,967] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 00:55:06,967] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 00:55:06,967] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 00:55:06,967] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 01:00:06,978] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 01:00:06,980] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 01:00:06,982] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 01:00:06,982] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 01:04:25,688] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-14 01:04:25,688] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-14 01:04:25,688] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-14 01:04:25,692] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),myFirstTopic-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-14 01:04:25,861] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:04:25,862] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:04:25,862] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:04:25,862] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-14 01:04:25,862] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-14 01:04:25,863] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:04:25,863] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:04:25,863] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-14 01:04:25,864] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-14 01:04:25,864] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-14 01:04:25,864] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-14 01:12:50,200] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:12:50,225] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 3 and epoch zk version is now 3 (kafka.controller.KafkaController)
[2025-01-14 01:12:50,227] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-14 01:12:50,230] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-14 01:12:50,232] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-14 01:12:50,234] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-14 01:12:50,249] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 177) (kafka.controller.KafkaController)
[2025-01-14 01:12:50,261] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-14 01:12:50,285] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-14 01:12:50,297] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-14 01:12:50,299] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-14 01:12:50,300] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-14 01:12:50,300] INFO [Controller id=0] Current list of topics in the cluster: HashSet(myFirstTopic, __consumer_offsets) (kafka.controller.KafkaController)
[2025-01-14 01:12:50,301] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-14 01:12:50,308] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-14 01:12:50,308] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-14 01:12:50,308] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-14 01:12:50,308] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-14 01:12:50,308] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-14 01:12:50,324] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:12:50,331] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:12:50,335] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-14 01:12:50,353] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:12:50,353] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=myFirstTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:12:50,354] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:12:50,354] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:12:50,354] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, myFirstTopic-0 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:12:50,354] INFO [Controller id=0] Ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2025-01-14 01:12:50,354] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-14 01:12:50,354] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-14 01:12:50,354] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-14 01:12:50,354] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-14 01:12:50,354] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-14 01:12:50,369] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-14 01:12:50,455] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-14 01:12:55,381] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 01:12:55,381] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 01:12:55,390] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 01:12:55,391] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 01:13:24,643] INFO [Controller id=0] New topics: [Set(kafka-chat)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(kafka-chat,Some(gBsFldnWRPCyy42oodrP_g),Map(kafka-chat-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-14 01:13:24,643] INFO [Controller id=0] New partition creation callback for kafka-chat-0 (kafka.controller.KafkaController)
[2025-01-14 01:17:55,401] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 01:17:55,401] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 01:17:55,402] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 01:17:55,402] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 01:21:08,462] DEBUG [Controller id=0] Read current producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=1000, size=1000), Zk path version 2 (kafka.controller.KafkaController)
[2025-01-14 01:21:08,466] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=2000, size=1000) by writing to Zk with path version 3 (kafka.controller.KafkaController)
[2025-01-14 01:22:55,412] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 01:22:55,412] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 01:22:55,416] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 01:22:55,416] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 01:25:58,948] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-14 01:25:58,948] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-14 01:25:58,948] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-14 01:25:58,951] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),myFirstTopic-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-14 01:25:59,117] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:25:59,117] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:25:59,117] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:25:59,117] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-14 01:25:59,117] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-14 01:25:59,117] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:25:59,117] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:25:59,117] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-14 01:25:59,117] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-14 01:25:59,117] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-14 01:25:59,117] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-14 01:30:38,078] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:30:38,103] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2025-01-14 01:30:38,106] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2025-01-14 01:30:38,133] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-14 01:30:38,137] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-14 01:30:38,139] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-14 01:30:38,141] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-14 01:30:38,151] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2025-01-14 01:30:38,155] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-14 01:30:38,159] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-14 01:30:38,165] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-14 01:30:38,166] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-14 01:30:38,167] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-14 01:30:38,167] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-14 01:30:38,167] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-14 01:30:38,169] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-14 01:30:38,169] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-14 01:30:38,169] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-14 01:30:38,170] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-14 01:30:38,171] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-14 01:30:38,180] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:30:38,181] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:30:38,185] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:30:38,185] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:30:38,186] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:30:38,186] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:30:38,191] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:30:38,191] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2025-01-14 01:30:38,193] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-14 01:30:38,198] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-14 01:30:38,198] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-14 01:30:38,199] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-14 01:30:38,199] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-14 01:30:38,201] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-14 01:30:38,221] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-14 01:30:38,297] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-14 01:30:43,228] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 01:30:43,229] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 01:35:43,235] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 01:35:43,235] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 01:39:43,554] INFO [Controller id=0] New topics: [Set(kafka-chat)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(kafka-chat,Some(p9UvkfcfSymVJLTTcOXqkQ),Map(kafka-chat-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-14 01:39:43,554] INFO [Controller id=0] New partition creation callback for kafka-chat-0 (kafka.controller.KafkaController)
[2025-01-14 01:39:43,583] INFO [Controller id=0] New topics: [Set(__consumer_offsets)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(__consumer_offsets,Some(2YO6ABKOTQGX91HRZWMuUg),HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-14 01:39:43,583] INFO [Controller id=0] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2025-01-14 01:40:10,248] DEBUG [Controller id=0] There is no producerId block yet (Zk path version 0), creating the first block (kafka.controller.KafkaController)
[2025-01-14 01:40:10,254] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000) by writing to Zk with path version 1 (kafka.controller.KafkaController)
[2025-01-14 01:40:33,258] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-14 01:40:33,258] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-14 01:40:33,258] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-14 01:40:33,261] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-14 01:40:33,428] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:40:33,428] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:40:33,428] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 01:40:33,429] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-14 01:40:33,429] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-14 01:40:33,429] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 01:40:33,430] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 01:40:33,430] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-14 01:40:33,430] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-14 01:40:33,430] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-14 01:40:33,431] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-14 04:29:36,523] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 04:29:36,554] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2025-01-14 04:29:36,556] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-14 04:29:36,560] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-14 04:29:36,567] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-14 04:29:36,570] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-14 04:29:36,587] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 157) (kafka.controller.KafkaController)
[2025-01-14 04:29:36,602] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-14 04:29:36,641] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-14 04:29:36,652] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-14 04:29:36,653] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-14 04:29:36,654] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-14 04:29:36,658] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-14 04:29:36,659] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-14 04:29:36,687] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-14 04:29:36,687] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-14 04:29:36,688] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-14 04:29:36,688] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-14 04:29:36,689] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-14 04:29:36,704] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 04:29:36,716] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 04:29:36,743] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-14 04:29:36,799] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 04:29:36,799] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 04:29:36,800] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 04:29:36,804] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 04:29:36,806] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 04:29:36,807] INFO [Controller id=0] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2025-01-14 04:29:36,811] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-14 04:29:36,812] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-14 04:29:36,812] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-14 04:29:36,813] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-14 04:29:36,815] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-14 04:29:36,832] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-14 04:29:36,870] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-14 04:29:41,834] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 04:29:41,834] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 04:29:41,837] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 04:29:41,838] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 04:33:08,691] DEBUG [Controller id=0] Read current producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000), Zk path version 1 (kafka.controller.KafkaController)
[2025-01-14 04:33:08,695] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=1000, size=1000) by writing to Zk with path version 2 (kafka.controller.KafkaController)
[2025-01-14 04:34:41,840] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-14 04:34:41,840] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-14 04:34:41,842] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-14 04:34:41,842] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-14 04:35:45,160] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-14 04:35:45,161] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-14 04:35:45,161] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-14 04:35:45,163] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-14 04:35:45,339] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 04:35:45,339] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 04:35:45,340] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-14 04:35:45,340] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-14 04:35:45,340] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-14 04:35:45,341] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-14 04:35:45,341] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-14 04:35:45,342] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-14 04:35:45,342] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-14 04:35:45,342] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-14 04:35:45,343] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:16:06,411] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:16:06,435] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2025-01-16 22:16:06,438] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2025-01-16 22:16:06,472] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 22:16:06,474] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 22:16:06,477] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 22:16:06,478] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 22:16:06,490] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2025-01-16 22:16:06,495] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:16:06,498] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:16:06,504] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:16:06,505] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:16:06,505] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:16:06,506] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:16:06,506] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 22:16:06,507] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 22:16:06,508] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:16:06,508] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 22:16:06,508] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-16 22:16:06,509] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 22:16:06,518] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:16:06,519] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:16:06,523] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:16:06,523] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:16:06,524] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:16:06,524] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:16:06,531] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:16:06,531] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2025-01-16 22:16:06,532] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:16:06,538] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:16:06,538] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:16:06,539] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:16:06,539] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 22:16:06,541] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 22:16:06,565] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 22:16:06,644] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:16:11,568] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:16:11,568] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:16:12,194] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:16:12,195] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:16:12,198] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:16:12,199] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:16:12,202] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:16:12,202] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:16:12,204] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45) (kafka.controller.KafkaController)
[2025-01-16 22:16:12,229] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:16:12,241] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:16:12,318] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:16:12,429] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:16:18,311] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:16:18,311] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:16:18,314] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:16:18,314] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:16:18,315] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:16:18,316] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-16 22:16:18,317] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:16:18,348] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:16:18,359] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:16:18,435] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:16:18,540] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:17:37,148] INFO [Controller id=0] New topics: [Set(kafka-chat)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(kafka-chat,Some(BOebwcM7SIGiwrLcbzAIzA),Map(kafka-chat-0 -> ReplicaAssignment(replicas=1,0, addingReplicas=, removingReplicas=), kafka-chat-1 -> ReplicaAssignment(replicas=0,2, addingReplicas=, removingReplicas=), kafka-chat-2 -> ReplicaAssignment(replicas=2,1, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-16 22:17:37,149] INFO [Controller id=0] New partition creation callback for kafka-chat-0,kafka-chat-1,kafka-chat-2 (kafka.controller.KafkaController)
[2025-01-16 22:20:49,050] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-16 22:20:49,051] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-16 22:20:49,051] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:20:49,085] TRACE [Controller id=0] All leaders = kafka-chat-0 -> (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 22:20:49,116] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=61, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:20:49,207] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:20:49,207] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:20:49,207] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:20:49,207] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:20:49,208] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:20:49,208] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:20:49,209] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:20:49,210] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:20:49,219] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:20:49,219] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:20:49,220] ERROR [RequestSendThread controllerId=0] Controller 0 fails to send a request to broker 127.0.0.1:9094 (id: 2 rack: null) (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:20:49,220] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:20:49,220] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:20:49,222] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:20:49,224] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:20:49,227] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:20:49,227] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45) (kafka.controller.KafkaController)
[2025-01-16 22:21:11,579] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:21:11,579] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:21:11,583] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2025-01-16 22:21:11,585] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:21:11,585] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2025-01-16 22:21:11,585] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:21:11,585] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(kafka-chat-2 -> List(2, 1)) (kafka.controller.KafkaController)
[2025-01-16 22:21:11,585] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:21:11,586] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:21:42,263] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:21:42,263] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:21:42,266] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:21:42,266] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:21:42,267] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:21:42,268] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:21:42,269] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:21:42,299] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:21:42,311] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:21:42,380] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:21:42,485] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:21:42,633] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:21:42,637] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-16 22:21:42,644] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:21:42,647] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-16 22:21:44,351] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:21:44,351] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-16 22:21:44,351] DEBUG [Controller id=0] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 22:21:44,357] TRACE [Controller id=0] All leaders = kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),kafka-chat-1 -> (Leader:0,ISR:0,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:2,ControllerEpoch:1),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 22:21:44,478] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:21:44,478] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:21:44,478] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:21:44,478] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:21:44,479] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:21:44,479] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:21:44,479] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:21:44,480] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:21:44,488] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 22:21:44,488] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:21:44,488] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:21:44,488] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:21:44,490] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:21:44,490] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:21:44,493] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:21:44,493] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:22:36,196] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:22:36,196] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:22:36,199] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:22:36,199] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:22:36,200] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:22:36,201] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 111, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:22:36,201] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:22:36,232] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:22:36,245] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:22:36,319] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:22:36,424] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:22:36,548] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 22:22:36,551] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=0, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-16 22:22:36,559] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:22:36,561] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-16 22:22:54,898] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:22:54,898] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:22:54,898] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-16 22:22:54,898] TRACE [Controller id=0] All leaders = kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:1),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:1),kafka-chat-2 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:4,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 22:22:55,005] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:22:55,016] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:22:55,016] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:22:55,016] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:22:55,016] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-16 22:22:55,016] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:22:55,016] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,016] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,021] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:22:55,039] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2025-01-16 22:22:55,040] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 22:22:55,042] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 22:22:55,043] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 22:22:55,042] DEBUG [Controller id=1] Broker 2 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-16 22:22:55,043] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 22:22:55,048] INFO [Controller id=2] Initialized broker epochs cache: HashMap(1 -> 111, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:22:55,057] DEBUG [Controller id=2] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2025-01-16 22:22:55,059] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:22:55,066] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:22:55,066] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,066] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,066] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2025-01-16 22:22:55,066] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:22:55,066] INFO [Controller id=2] Current list of topics in the cluster: HashSet(kafka-chat) (kafka.controller.KafkaController)
[2025-01-16 22:22:55,066] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 22:22:55,066] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 22:22:55,066] INFO [Controller id=2] List of topics ineligible for deletion: kafka-chat (kafka.controller.KafkaController)
[2025-01-16 22:22:55,066] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 22:22:55,066] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 22:22:55,066] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 22:22:55,081] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,081] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:22:55,082] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:22:55,083] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:22:55,083] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:22:55,099] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=kafka-chat,Partition=1,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:22:55,099] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:22:55,099] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:22:55,099] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(kafka-chat-0 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, kafka-chat-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:22:55,099] INFO [Controller id=2] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2025-01-16 22:22:55,099] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:22:55,099] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:22:55,099] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:22:55,099] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 22:22:55,099] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 22:22:55,120] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 22:23:00,128] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:23:00,130] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:23:00,133] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 Map(kafka-chat-1 -> List(0, 2)) (kafka.controller.KafkaController)
[2025-01-16 22:23:00,134] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:23:00,135] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:23:00,135] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2025-01-16 22:23:00,135] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:23:00,135] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2025-01-16 22:23:00,135] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:23:11,622] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:23:11,622] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:23:11,625] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:23:11,626] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-16 22:23:11,630] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-16 22:23:11,630] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:23:11,631] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 135, 1 -> 111, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:23:11,656] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:23:11,669] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:23:11,742] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:23:11,851] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:23:12,001] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:23:12,007] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=2, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-16 22:23:12,013] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 22:23:12,015] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-16 22:25:43,620] INFO [Controller id=2] New topics: [Set(__consumer_offsets)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(__consumer_offsets,Some(fiIvqMSxT6SqhBjF5ijxKQ),HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-16 22:25:43,622] INFO [Controller id=2] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2025-01-16 22:26:49,418] DEBUG [Controller id=2] There is no producerId block yet (Zk path version 0), creating the first block (kafka.controller.KafkaController)
[2025-01-16 22:26:49,423] INFO [Controller id=2] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000) by writing to Zk with path version 1 (kafka.controller.KafkaController)
[2025-01-16 22:26:49,539] DEBUG [Controller id=2] Read current producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000), Zk path version 1 (kafka.controller.KafkaController)
[2025-01-16 22:26:49,542] INFO [Controller id=2] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=1, firstProducerId=1000, size=1000) by writing to Zk with path version 2 (kafka.controller.KafkaController)
[2025-01-16 22:28:00,145] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:28:00,145] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:28:00,146] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(kafka-chat-1 -> List(0, 2)) (kafka.controller.KafkaController)
[2025-01-16 22:28:00,146] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 22:28:00,146] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:28:00,146] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:28:00,146] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:28:00,146] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:29:45,206] INFO [Controller id=2] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:29:45,208] DEBUG [Controller id=2] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:29:45,209] DEBUG [Controller id=2] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-16 22:29:45,219] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),kafka-chat-2 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:4,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:29:45,239] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=135, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=2, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=2, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:29:45,346] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:29:45,384] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:29:45,384] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:29:45,384] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:29:45,384] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:29:45,385] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:29:45,385] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:29:45,386] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:29:45,387] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:29:45,396] INFO [Controller id=2] Newly added brokers: , deleted brokers: 0, bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-16 22:29:45,397] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:29:45,397] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=135, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=2, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=2, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:29:45,398] TRACE [RequestSendThread controllerId=2] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:29:45,398] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:29:45,398] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:29:45,400] INFO [Controller id=2] Broker failure callback for 0 (kafka.controller.KafkaController)
[2025-01-16 22:29:45,400] INFO [Controller id=2] Removed 0 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:29:45,435] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-16 22:29:45,436] INFO [Controller id=2] Updated broker epochs cache: HashMap(1 -> 111, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:30:03,734] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:30:03,735] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:30:03,737] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:30:03,737] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-16 22:30:03,740] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:30:03,754] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-16 22:30:03,755] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 279, 1 -> 111, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:30:03,771] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:30:03,783] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:30:03,856] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:30:03,962] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:30:04,128] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 22:30:04,136] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6). (kafka.controller.KafkaController)
[2025-01-16 22:30:04,138] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:30:04,140] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=2, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6). (kafka.controller.KafkaController)
[2025-01-16 22:30:06,728] INFO [Controller id=2] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:30:06,728] DEBUG [Controller id=2] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-16 22:30:06,728] DEBUG [Controller id=2] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 22:30:06,742] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:7,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:30:06,761] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=111, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=2, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:30:06,870] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:30:06,915] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:30:06,915] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:30:06,915] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:30:06,916] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:30:06,916] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:30:06,916] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:30:06,917] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:30:06,917] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:30:06,923] INFO [Controller id=2] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 22:30:06,923] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:30:06,923] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=111, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=2, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:30:06,924] TRACE [RequestSendThread controllerId=2] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:30:06,924] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:30:06,924] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:30:06,925] INFO [Controller id=2] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:30:06,925] INFO [Controller id=2] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:30:06,945] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:30:06,945] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 279, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:30:22,175] INFO [Controller id=2] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:30:22,176] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:30:22,178] INFO [Controller id=2] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:30:22,178] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:30:22,181] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:30:22,195] DEBUG [Controller id=2] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:30:22,196] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 279, 1 -> 333, 2 -> 90) (kafka.controller.KafkaController)
[2025-01-16 22:30:22,212] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:30:22,225] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:30:22,296] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:30:22,409] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:30:22,552] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:30:22,552] DEBUG [Controller id=2] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6). (kafka.controller.KafkaController)
[2025-01-16 22:30:22,563] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 22:30:22,564] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=0, leaderEpoch=4, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=8). (kafka.controller.KafkaController)
[2025-01-16 22:30:25,966] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-16 22:30:25,966] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-16 22:30:25,966] DEBUG [Controller id=2] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:30:25,973] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),kafka-chat-0 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:8,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:7,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:7,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:30:26,127] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:30:26,128] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:30:26,128] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:30:26,128] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:30:26,128] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-16 22:30:26,128] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:30:26,129] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:30:26,129] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,129] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,129] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,130] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,130] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,130] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,130] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,131] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,131] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,131] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:30:26,144] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 3 and epoch zk version is now 3 (kafka.controller.KafkaController)
[2025-01-16 22:30:26,146] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 22:30:26,148] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 22:30:26,150] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 22:30:26,149] DEBUG [Controller id=1] Broker 0 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-16 22:30:26,151] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 22:30:26,155] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 279, 1 -> 333) (kafka.controller.KafkaController)
[2025-01-16 22:30:26,163] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0, 1) (kafka.controller.KafkaController)
[2025-01-16 22:30:26,176] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:30:26,180] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:30:26,182] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,182] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,184] INFO [Controller id=0] Currently active brokers in the cluster: Set(0, 1) (kafka.controller.KafkaController)
[2025-01-16 22:30:26,184] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:30:26,184] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-16 22:30:26,184] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 22:30:26,187] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 22:30:26,187] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-16 22:30:26,187] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 22:30:26,187] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 22:30:26,188] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 22:30:26,193] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,193] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:30:26,193] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:30:26,196] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:30:26,209] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:30:26,233] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=34,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=40,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=1] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:30:26,233] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:30:26,236] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:30:26,253] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:30:26,254] INFO [Controller id=0] Ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2025-01-16 22:30:26,256] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:30:26,256] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:30:26,256] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:30:26,257] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 22:30:26,258] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 22:30:26,263] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 22:30:31,270] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:30:31,270] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:30:31,273] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:30:31,274] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:30:31,280] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 0)) (kafka.controller.KafkaController)
[2025-01-16 22:30:31,280] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.058823529411764705 (kafka.controller.KafkaController)
[2025-01-16 22:30:31,280] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-22 -> List(2), __consumer_offsets-4 -> List(2), kafka-chat-2 -> List(2, 1), __consumer_offsets-25 -> List(2), __consumer_offsets-49 -> List(2), __consumer_offsets-31 -> List(2), __consumer_offsets-37 -> List(2), __consumer_offsets-19 -> List(2), __consumer_offsets-13 -> List(2), __consumer_offsets-43 -> List(2), __consumer_offsets-1 -> List(2), __consumer_offsets-34 -> List(2), __consumer_offsets-7 -> List(2), __consumer_offsets-46 -> List(2), __consumer_offsets-16 -> List(2), __consumer_offsets-28 -> List(2), __consumer_offsets-10 -> List(2), __consumer_offsets-40 -> List(2)) (kafka.controller.KafkaController)
[2025-01-16 22:30:31,280] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:30:31,282] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:31:13,339] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:31:13,339] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:31:13,343] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:31:13,343] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:31:13,349] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:31:13,365] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:31:13,366] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 279, 1 -> 333, 2 -> 390) (kafka.controller.KafkaController)
[2025-01-16 22:31:13,380] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:31:13,394] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:31:13,466] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:31:13,571] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:31:13,712] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:31:13,717] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=4, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=8). (kafka.controller.KafkaController)
[2025-01-16 22:31:13,737] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:31:13,740] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=4, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=8). (kafka.controller.KafkaController)
[2025-01-16 22:31:45,768] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-16 22:31:45,769] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-16 22:31:45,769] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:31:45,777] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:8,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:31:45,799] WARN [RequestSendThread controllerId=0] Controller 0 epoch 3 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=3, brokerEpoch=390, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=4, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=4, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:31:45,906] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:31:45,940] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:31:45,940] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:31:45,940] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:31:45,940] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:31:45,941] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:31:45,941] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:31:45,941] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:31:45,942] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:31:45,949] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:31:45,950] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:31:45,950] WARN [RequestSendThread controllerId=0] Controller 0 epoch 3 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=3, brokerEpoch=390, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=4, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=4, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:31:45,951] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:31:45,951] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:31:45,951] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:31:45,952] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:31:45,953] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:31:45,971] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:31:45,972] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 279, 1 -> 333) (kafka.controller.KafkaController)
[2025-01-16 22:32:02,598] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:32:02,598] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:32:02,602] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:32:02,602] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:32:02,604] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:32:02,617] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:32:02,618] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 279, 1 -> 333, 2 -> 445) (kafka.controller.KafkaController)
[2025-01-16 22:32:02,635] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:32:02,647] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:32:02,710] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:32:02,817] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:32:02,943] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:32:02,945] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=10). (kafka.controller.KafkaController)
[2025-01-16 22:32:02,967] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:32:02,969] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=10). (kafka.controller.KafkaController)
[2025-01-16 22:32:11,583] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-16 22:32:11,583] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-16 22:32:11,583] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:32:11,591] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:8,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:11,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:11,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:32:11,610] WARN [RequestSendThread controllerId=0] Controller 0 epoch 3 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=3, brokerEpoch=445, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=5, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=5, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:32:11,713] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:32:11,770] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:32:11,771] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:32:11,771] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:32:11,771] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:32:11,771] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:32:11,772] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:32:11,772] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:32:11,773] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:32:11,779] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:32:11,779] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:32:11,779] WARN [RequestSendThread controllerId=0] Controller 0 epoch 3 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=3, brokerEpoch=445, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=5, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=5, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:32:11,780] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:32:11,780] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:32:11,780] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:32:11,781] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:32:11,781] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:32:11,795] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:32:11,796] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 279, 1 -> 333) (kafka.controller.KafkaController)
[2025-01-16 22:35:31,293] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:35:31,293] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:35:31,293] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:35:31,293] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:35:31,294] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 0)) (kafka.controller.KafkaController)
[2025-01-16 22:35:31,294] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.058823529411764705 (kafka.controller.KafkaController)
[2025-01-16 22:35:31,294] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-22 -> List(2), __consumer_offsets-4 -> List(2), kafka-chat-2 -> List(2, 1), __consumer_offsets-25 -> List(2), __consumer_offsets-49 -> List(2), __consumer_offsets-31 -> List(2), __consumer_offsets-37 -> List(2), __consumer_offsets-19 -> List(2), __consumer_offsets-13 -> List(2), __consumer_offsets-43 -> List(2), __consumer_offsets-1 -> List(2), __consumer_offsets-34 -> List(2), __consumer_offsets-7 -> List(2), __consumer_offsets-46 -> List(2), __consumer_offsets-16 -> List(2), __consumer_offsets-28 -> List(2), __consumer_offsets-10 -> List(2), __consumer_offsets-40 -> List(2)) (kafka.controller.KafkaController)
[2025-01-16 22:35:31,294] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:35:31,294] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:39:44,690] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:39:44,690] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:39:44,693] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:39:44,693] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:39:44,697] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:39:44,709] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:39:44,709] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 279, 1 -> 333, 2 -> 500) (kafka.controller.KafkaController)
[2025-01-16 22:39:44,725] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:39:44,737] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:39:44,815] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:39:44,921] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:39:45,073] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:39:45,076] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=12). (kafka.controller.KafkaController)
[2025-01-16 22:39:45,077] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:39:45,079] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=12). (kafka.controller.KafkaController)
[2025-01-16 22:40:31,302] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:40:31,302] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:40:31,302] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:40:31,302] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:40:31,302] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 0)) (kafka.controller.KafkaController)
[2025-01-16 22:40:31,302] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.058823529411764705 (kafka.controller.KafkaController)
[2025-01-16 22:40:31,303] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(kafka-chat-2 -> List(2, 1)) (kafka.controller.KafkaController)
[2025-01-16 22:40:31,303] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 22:43:37,312] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-16 22:43:37,312] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-16 22:43:37,312] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:43:37,318] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:8,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:43:37,333] WARN [RequestSendThread controllerId=0] Controller 0 epoch 3 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=3, brokerEpoch=500, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=6, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=6, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:43:37,441] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:43:37,483] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:37,484] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:37,484] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:37,484] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:43:37,484] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:43:37,485] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:43:37,485] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:43:37,486] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:43:37,493] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:43:37,493] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:43:37,493] WARN [RequestSendThread controllerId=0] Controller 0 epoch 3 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=3, brokerEpoch=500, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=6, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=6, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:43:37,494] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:43:37,494] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:43:37,494] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:43:37,495] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:43:37,495] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:43:37,509] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:43:37,509] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 279, 1 -> 333) (kafka.controller.KafkaController)
[2025-01-16 22:43:40,465] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:43:40,465] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-16 22:43:40,465] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:43:40,472] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:43:41,964] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:43:41,964] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:43:41,964] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:43:41,966] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:43:45,485] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:43:45,485] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:43:45,485] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:43:45,494] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:43:46,979] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:43:46,979] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:43:46,979] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:43:46,984] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:43:50,515] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:43:50,515] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:43:50,515] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:43:50,524] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-16 22:43:50,667] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:50,667] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:50,667] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:50,668] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:43:50,668] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:43:50,668] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:43:50,669] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:43:50,669] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:43:50,676] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:43:50,676] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:43:50,676] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:43:50,676] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:43:50,677] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:43:50,677] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:43:50,696] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:43:50,696] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 279) (kafka.controller.KafkaController)
[2025-01-16 22:43:51,995] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:43:51,995] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:43:51,995] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:43:51,997] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-5 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-38 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-44 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-23 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-14 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3),__consumer_offsets-2 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) (kafka.controller.KafkaController)
[2025-01-16 22:43:52,141] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:52,141] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:52,142] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:43:52,142] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:43:52,142] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:43:52,142] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:43:52,143] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:43:52,143] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:43:52,143] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:43:52,143] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:43:52,143] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:45:19,139] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:45:19,159] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 4 and epoch zk version is now 4 (kafka.controller.KafkaController)
[2025-01-16 22:45:19,162] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 22:45:19,164] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 22:45:19,166] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 22:45:19,168] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 22:45:19,182] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 575) (kafka.controller.KafkaController)
[2025-01-16 22:45:19,196] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:45:19,226] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:45:19,255] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:45:19,256] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:45:19,256] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:45:19,256] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-16 22:45:19,259] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 22:45:19,265] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 22:45:19,265] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-16 22:45:19,265] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 22:45:19,266] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 22:45:19,267] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 22:45:19,276] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:45:19,281] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:45:19,287] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:45:19,300] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:45:19,360] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=34,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=40,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:45:19,361] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:45:19,364] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:45:19,394] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:45:19,401] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:45:19,401] INFO [Controller id=0] Ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2025-01-16 22:45:19,406] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:45:19,406] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:45:19,406] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:45:19,407] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 22:45:19,408] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 22:45:19,416] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 22:45:21,485] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:45:21,485] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:45:21,489] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:45:21,489] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:45:21,493] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:45:21,521] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:45:21,521] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:45:21,522] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 575, 1 -> 627) (kafka.controller.KafkaController)
[2025-01-16 22:45:21,535] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:45:21,599] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:45:21,706] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:45:21,893] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 22:45:21,898] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=0, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=10). (kafka.controller.KafkaController)
[2025-01-16 22:45:24,065] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:45:24,065] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:45:24,065] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:45:24,065] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:45:24,072] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:45:24,083] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:45:24,083] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 575, 1 -> 627, 2 -> 661) (kafka.controller.KafkaController)
[2025-01-16 22:45:24,099] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:45:24,115] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:45:24,177] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:45:24,280] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:45:24,409] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:45:24,412] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=7, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=14). (kafka.controller.KafkaController)
[2025-01-16 22:45:24,420] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:45:24,421] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:45:24,424] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:45:24,425] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:45:24,434] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 0)) (kafka.controller.KafkaController)
[2025-01-16 22:45:24,434] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.058823529411764705 (kafka.controller.KafkaController)
[2025-01-16 22:45:24,434] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(kafka-chat-2 -> List(2, 1)) (kafka.controller.KafkaController)
[2025-01-16 22:45:24,434] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 22:45:24,437] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:45:24,444] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=10, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=17). (kafka.controller.KafkaController)
[2025-01-16 22:48:31,550] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-16 22:48:31,550] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-16 22:48:31,550] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:48:31,565] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),kafka-chat-0 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:15,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:18,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 22:48:31,590] WARN [RequestSendThread controllerId=0] Controller 0 epoch 4 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=4, brokerEpoch=661, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=7, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=10, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:48:31,704] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:48:31,721] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:31,721] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:31,721] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:31,722] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:48:31,722] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:48:31,722] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:48:31,722] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:48:31,723] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:48:31,731] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:48:31,731] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:48:31,731] WARN [RequestSendThread controllerId=0] Controller 0 epoch 4 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=4, brokerEpoch=661, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=7, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=10, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:48:31,732] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:48:31,732] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:48:31,732] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:48:31,734] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:48:31,735] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:48:31,755] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:48:31,755] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 575, 1 -> 627) (kafka.controller.KafkaController)
[2025-01-16 22:48:33,126] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:48:33,126] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-16 22:48:33,126] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:48:33,134] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:11,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:15,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:18,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 22:48:34,360] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:48:34,360] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:48:34,360] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:48:34,363] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:11,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:15,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:18,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 22:48:38,144] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:48:38,144] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:48:38,144] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:48:38,149] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:11,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:15,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:18,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 22:48:39,376] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:48:39,376] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:48:39,376] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:48:39,383] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:11,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:15,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:18,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 22:48:43,154] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:48:43,154] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:48:43,154] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:48:43,158] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:11,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:15,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:18,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 22:48:43,290] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:43,290] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:43,291] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:43,291] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:48:43,291] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:48:43,291] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:48:43,292] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:48:43,293] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:48:43,300] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:48:43,300] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:48:43,300] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:48:43,300] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:48:43,301] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:48:43,301] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:48:43,326] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:48:43,326] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 575) (kafka.controller.KafkaController)
[2025-01-16 22:48:44,394] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:48:44,394] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:48:44,394] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 22:48:44,397] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:11,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:15,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:19,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 22:48:44,530] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:44,530] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:44,530] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:48:44,531] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:48:44,531] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:48:44,531] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:48:44,532] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:48:44,532] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:48:44,532] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:48:44,532] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:48:44,533] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:49:43,886] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:49:43,903] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 5 and epoch zk version is now 5 (kafka.controller.KafkaController)
[2025-01-16 22:49:43,904] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 22:49:43,906] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 22:49:43,908] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 22:49:43,910] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 22:49:43,919] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 736) (kafka.controller.KafkaController)
[2025-01-16 22:49:43,932] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:49:43,955] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:49:43,961] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:49:43,963] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:49:43,963] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:49:43,963] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-16 22:49:43,964] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 22:49:43,967] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 22:49:43,967] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-16 22:49:43,972] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 22:49:43,973] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 22:49:43,975] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 22:49:43,988] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:49:43,994] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:49:44,001] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:49:44,016] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:49:44,065] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=34,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=40,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:49:44,065] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:49:44,067] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:49:44,102] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:49:44,103] INFO [Controller id=0] Ready to serve as the new controller with epoch 5 (kafka.controller.KafkaController)
[2025-01-16 22:49:44,107] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:49:44,107] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:49:44,107] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:49:44,107] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 22:49:44,108] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 22:49:44,115] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 22:49:44,119] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:49:49,126] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:49:49,127] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:49:49,137] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:49:49,140] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:49:49,141] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(__consumer_offsets-8 -> List(1), __consumer_offsets-35 -> List(1), __consumer_offsets-47 -> List(1), __consumer_offsets-38 -> List(1), __consumer_offsets-17 -> List(1), __consumer_offsets-29 -> List(1), __consumer_offsets-32 -> List(1), __consumer_offsets-41 -> List(1), __consumer_offsets-23 -> List(1), __consumer_offsets-11 -> List(1), kafka-chat-0 -> List(1, 0), __consumer_offsets-2 -> List(1), __consumer_offsets-14 -> List(1), __consumer_offsets-20 -> List(1), __consumer_offsets-44 -> List(1), __consumer_offsets-5 -> List(1), __consumer_offsets-26 -> List(1)) (kafka.controller.KafkaController)
[2025-01-16 22:49:49,141] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:49:49,145] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:49:49,145] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-22 -> List(2), __consumer_offsets-4 -> List(2), kafka-chat-2 -> List(2, 1), __consumer_offsets-25 -> List(2), __consumer_offsets-49 -> List(2), __consumer_offsets-31 -> List(2), __consumer_offsets-37 -> List(2), __consumer_offsets-19 -> List(2), __consumer_offsets-13 -> List(2), __consumer_offsets-43 -> List(2), __consumer_offsets-1 -> List(2), __consumer_offsets-34 -> List(2), __consumer_offsets-7 -> List(2), __consumer_offsets-46 -> List(2), __consumer_offsets-16 -> List(2), __consumer_offsets-28 -> List(2), __consumer_offsets-10 -> List(2), __consumer_offsets-40 -> List(2)) (kafka.controller.KafkaController)
[2025-01-16 22:49:49,145] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:49:49,146] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:50:33,149] DEBUG [Controller id=0] Delete topics listener fired for topics kafka-chat to be deleted (kafka.controller.KafkaController)
[2025-01-16 22:50:33,149] INFO [Controller id=0] Starting topic deletion for topics kafka-chat (kafka.controller.KafkaController)
[2025-01-16 22:50:33,150] INFO [Topic Deletion Manager 0] Handling deletion for topics kafka-chat (kafka.controller.TopicDeletionManager)
[2025-01-16 22:50:33,151] INFO [Topic Deletion Manager 0] Deletion of topic kafka-chat (re)started (kafka.controller.TopicDeletionManager)
[2025-01-16 22:50:33,154] DEBUG [Topic Deletion Manager 0] Dead Replicas ([Topic=kafka-chat,Partition=0,Replica=1],[Topic=kafka-chat,Partition=2,Replica=2],[Topic=kafka-chat,Partition=2,Replica=1],[Topic=kafka-chat,Partition=1,Replica=2]) found for topic kafka-chat (kafka.controller.TopicDeletionManager)
[2025-01-16 22:50:33,162] INFO [Topic Deletion Manager 0] Halted deletion of topics kafka-chat due to offline replicas (kafka.controller.TopicDeletionManager)
[2025-01-16 22:50:33,195] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = Map(kafka-chat-0 -> KAFKA_STORAGE_ERROR, kafka-chat-1 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2025-01-16 22:50:33,196] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=kafka-chat,Partition=0,Replica=0],[Topic=kafka-chat,Partition=1,Replica=0]. Halting deletion for topics Set(kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 22:50:33,197] INFO [Topic Deletion Manager 0] Halted deletion of topics kafka-chat due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2025-01-16 22:50:33,197] INFO [Topic Deletion Manager 0] Handling deletion for topics kafka-chat (kafka.controller.TopicDeletionManager)
[2025-01-16 22:50:33,197] DEBUG [Topic Deletion Manager 0] Retrying deletion of topics kafka-chat since replicas [Topic=kafka-chat,Partition=1,Replica=0],[Topic=kafka-chat,Partition=2,Replica=2],[Topic=kafka-chat,Partition=1,Replica=2],[Topic=kafka-chat,Partition=2,Replica=1],[Topic=kafka-chat,Partition=0,Replica=1],[Topic=kafka-chat,Partition=0,Replica=0] were not successfully deleted (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:01,620] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:51:01,640] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 6 and epoch zk version is now 6 (kafka.controller.KafkaController)
[2025-01-16 22:51:01,641] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 22:51:01,643] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 22:51:01,645] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 22:51:01,646] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 22:51:01,656] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 795) (kafka.controller.KafkaController)
[2025-01-16 22:51:01,667] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:51:01,690] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:51:01,695] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:51:01,696] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:51:01,697] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:51:01,697] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-16 22:51:01,697] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 22:51:01,702] INFO [Controller id=0] List of topics to be deleted: kafka-chat (kafka.controller.KafkaController)
[2025-01-16 22:51:01,702] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-16 22:51:01,702] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 22:51:01,707] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(kafka-chat), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:01,730] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 22:51:01,740] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:51:01,745] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:51:01,751] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:51:01,768] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:51:01,815] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=34,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=40,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:51:01,816] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:51:01,818] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:51:01,852] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OfflinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OfflinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:51:01,852] INFO [Controller id=0] Ready to serve as the new controller with epoch 6 (kafka.controller.KafkaController)
[2025-01-16 22:51:01,854] INFO [Topic Deletion Manager 0] Handling deletion for topics kafka-chat (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:01,856] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:51:01,856] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:51:01,856] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:51:01,856] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 22:51:01,857] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 22:51:01,862] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 22:51:01,867] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:51:06,863] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:51:06,863] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:51:06,868] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:51:06,869] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:51:06,869] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(__consumer_offsets-8 -> List(1), __consumer_offsets-35 -> List(1), __consumer_offsets-47 -> List(1), __consumer_offsets-38 -> List(1), __consumer_offsets-17 -> List(1), __consumer_offsets-11 -> List(1), __consumer_offsets-29 -> List(1), __consumer_offsets-32 -> List(1), __consumer_offsets-41 -> List(1), __consumer_offsets-23 -> List(1), __consumer_offsets-2 -> List(1), __consumer_offsets-14 -> List(1), __consumer_offsets-20 -> List(1), __consumer_offsets-44 -> List(1), __consumer_offsets-5 -> List(1), __consumer_offsets-26 -> List(1)) (kafka.controller.KafkaController)
[2025-01-16 22:51:06,869] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:51:06,871] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:51:06,871] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-22 -> List(2), __consumer_offsets-4 -> List(2), __consumer_offsets-25 -> List(2), __consumer_offsets-49 -> List(2), __consumer_offsets-31 -> List(2), __consumer_offsets-37 -> List(2), __consumer_offsets-19 -> List(2), __consumer_offsets-13 -> List(2), __consumer_offsets-43 -> List(2), __consumer_offsets-1 -> List(2), __consumer_offsets-34 -> List(2), __consumer_offsets-7 -> List(2), __consumer_offsets-46 -> List(2), __consumer_offsets-16 -> List(2), __consumer_offsets-28 -> List(2), __consumer_offsets-10 -> List(2), __consumer_offsets-40 -> List(2)) (kafka.controller.KafkaController)
[2025-01-16 22:51:06,871] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:51:06,871] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:51:20,998] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:51:20,998] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:51:21,002] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:51:21,003] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:51:21,007] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:51:21,033] INFO [Controller id=0] Some replicas [Topic=kafka-chat,Partition=0,Replica=1],[Topic=kafka-chat,Partition=2,Replica=1] for topics scheduled for deletion kafka-chat are on the newly restarted brokers 1. Signaling restart of topic deletion for these topics (kafka.controller.KafkaController)
[2025-01-16 22:51:21,033] INFO [Topic Deletion Manager 0] Handling deletion for topics kafka-chat (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:21,034] INFO [Topic Deletion Manager 0] Deletion of topic kafka-chat (re)started (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:21,038] DEBUG [Topic Deletion Manager 0] Dead Replicas ([Topic=kafka-chat,Partition=2,Replica=2],[Topic=kafka-chat,Partition=1,Replica=2]) found for topic kafka-chat (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:21,039] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:51:21,049] INFO [Topic Deletion Manager 0] Halted deletion of topics kafka-chat due to offline replicas (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:21,049] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:51:21,050] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 795, 1 -> 847) (kafka.controller.KafkaController)
[2025-01-16 22:51:21,051] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:51:21,092] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = Map(kafka-chat-0 -> KAFKA_STORAGE_ERROR, kafka-chat-1 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2025-01-16 22:51:21,093] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=kafka-chat,Partition=0,Replica=0],[Topic=kafka-chat,Partition=1,Replica=0]. Halting deletion for topics Set(kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:21,093] INFO [Topic Deletion Manager 0] Halted deletion of topics kafka-chat due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:21,093] INFO [Topic Deletion Manager 0] Handling deletion for topics kafka-chat (kafka.controller.TopicDeletionManager)
[2025-01-16 22:51:37,430] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:51:37,430] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:51:37,430] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:51:37,430] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:51:37,431] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:51:37,431] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:51:37,431] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:51:37,432] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:52:24,432] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:52:24,455] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2025-01-16 22:52:24,458] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2025-01-16 22:52:24,485] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 22:52:24,488] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 22:52:24,491] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 22:52:24,493] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 22:52:24,502] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2025-01-16 22:52:24,506] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:52:24,511] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:52:24,516] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:52:24,517] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-16 22:52:24,517] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:52:24,517] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:52:24,517] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 22:52:24,519] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 22:52:24,519] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:52:24,520] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 22:52:24,520] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-16 22:52:24,521] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 22:52:24,529] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:52:24,529] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:52:24,533] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:52:24,533] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:52:24,534] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:52:24,534] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:52:24,540] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:52:24,541] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2025-01-16 22:52:24,541] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:52:24,547] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:52:24,547] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:52:24,547] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:52:24,548] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 22:52:24,549] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 22:52:24,570] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 22:52:24,658] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:52:26,898] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:52:26,898] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:52:26,902] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:52:26,902] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:52:26,905] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:52:26,906] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:52:26,908] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45) (kafka.controller.KafkaController)
[2025-01-16 22:52:26,931] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:52:26,943] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:52:27,018] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:52:27,125] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:52:29,583] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:52:29,583] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:52:29,924] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:52:29,924] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:52:29,927] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:52:29,927] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:52:29,928] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:52:29,929] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-16 22:52:29,930] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:52:29,957] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:52:29,968] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:52:30,042] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:52:30,154] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:52:34,447] INFO [Controller id=0] New topics: [Set(kafka-chat)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(kafka-chat,Some(1QcDRAdsThSXtxu8ZQ90yw),Map(kafka-chat-0 -> ReplicaAssignment(replicas=1,2, addingReplicas=, removingReplicas=), kafka-chat-1 -> ReplicaAssignment(replicas=0,1, addingReplicas=, removingReplicas=), kafka-chat-2 -> ReplicaAssignment(replicas=2,0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-16 22:52:34,447] INFO [Controller id=0] New partition creation callback for kafka-chat-0,kafka-chat-1,kafka-chat-2 (kafka.controller.KafkaController)
[2025-01-16 22:52:46,029] INFO [Controller id=0] New topics: [Set(__consumer_offsets)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(__consumer_offsets,Some(4ewz50QjRyC4LwUTdedqdQ),HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-16 22:52:46,030] INFO [Controller id=0] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2025-01-16 22:52:58,368] DEBUG [Controller id=0] There is no producerId block yet (Zk path version 0), creating the first block (kafka.controller.KafkaController)
[2025-01-16 22:52:58,373] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000) by writing to Zk with path version 1 (kafka.controller.KafkaController)
[2025-01-16 22:53:23,140] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-16 22:53:23,140] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-16 22:53:23,141] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:53:23,175] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-1 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 22:53:23,201] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=61, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:53:23,314] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:53:23,360] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:53:23,360] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:53:23,360] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:53:23,360] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:53:23,360] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:53:23,361] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:53:23,361] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:53:23,362] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:53:23,370] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 22:53:23,370] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:53:23,370] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=61, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:53:23,371] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:53:23,371] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:53:23,371] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:53:23,373] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:53:23,374] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:53:23,407] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:53:23,407] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45) (kafka.controller.KafkaController)
[2025-01-16 22:53:39,692] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:53:39,692] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:53:39,697] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:53:39,697] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 22:53:39,700] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:53:39,712] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 22:53:39,713] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:53:39,729] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:53:39,743] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:53:39,817] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:53:39,925] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:53:40,092] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:53:40,095] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=0, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-16 22:53:40,101] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 22:53:40,103] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-16 22:53:44,980] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:53:44,980] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-16 22:53:44,980] DEBUG [Controller id=0] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 22:53:44,990] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-2 -> (Leader:0,ISR:0,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 22:53:45,011] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=45, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:53:45,125] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:53:45,161] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:53:45,161] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:53:45,161] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:53:45,162] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:53:45,163] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:53:45,163] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:53:45,163] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:53:45,164] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:53:45,171] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 22:53:45,171] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:53:45,172] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=45, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:53:45,172] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:53:45,172] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:53:45,172] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:53:45,173] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:53:45,173] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:53:45,193] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:53:45,193] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:54:04,791] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:54:04,791] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:54:04,795] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:54:04,795] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:54:04,798] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:54:04,810] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:54:04,811] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 265, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:54:04,829] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:54:04,840] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:54:04,910] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:54:05,023] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:54:05,212] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:54:05,214] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-16 22:54:05,223] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 22:54:05,225] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=2, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-16 22:54:12,209] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:54:12,209] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:54:12,209] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-16 22:54:12,215] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-0 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:4,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),kafka-chat-1 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 22:54:12,381] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:54:12,381] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:54:12,381] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:54:12,381] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:54:12,381] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-16 22:54:12,382] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:54:12,382] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:54:12,382] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,382] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,382] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,383] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,383] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,383] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,384] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,384] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,384] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,385] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:54:12,400] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2025-01-16 22:54:12,402] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 22:54:12,404] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 22:54:12,405] DEBUG [Controller id=1] Broker 2 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-16 22:54:12,406] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 22:54:12,408] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 22:54:12,413] INFO [Controller id=2] Initialized broker epochs cache: HashMap(1 -> 265, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:54:12,420] DEBUG [Controller id=2] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2025-01-16 22:54:12,435] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:54:12,440] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:54:12,443] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,444] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,445] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2025-01-16 22:54:12,445] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 22:54:12,445] INFO [Controller id=2] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-16 22:54:12,445] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 22:54:12,448] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 22:54:12,448] INFO [Controller id=2] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-16 22:54:12,449] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 22:54:12,449] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 22:54:12,449] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 22:54:12,455] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,455] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:54:12,455] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:54:12,458] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:54:12,471] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:54:12,494] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:54:12,495] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:54:12,497] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:54:12,517] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:54:12,517] INFO [Controller id=2] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2025-01-16 22:54:12,519] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:54:12,520] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 22:54:12,520] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 22:54:12,520] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 22:54:12,521] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 22:54:12,526] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 22:54:17,532] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:54:17,533] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:54:17,537] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-13 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-16 -> List(0), kafka-chat-1 -> List(0, 1), __consumer_offsets-28 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2025-01-16 22:54:17,538] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 22:54:17,540] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 22:54:17,540] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 2)) (kafka.controller.KafkaController)
[2025-01-16 22:54:17,540] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 22:54:17,540] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:54:17,540] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 22:54:42,817] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:54:42,817] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:54:42,820] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:54:42,821] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-16 22:54:42,825] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:54:42,841] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-16 22:54:42,842] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 323, 1 -> 265, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:54:42,854] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:54:42,867] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:54:42,929] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:54:43,037] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:54:43,172] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:54:43,175] DEBUG [Controller id=2] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-16 22:54:43,192] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:54:43,194] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=1, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-16 22:55:20,041] INFO [Controller id=2] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 22:55:20,042] DEBUG [Controller id=2] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-16 22:55:20,042] DEBUG [Controller id=2] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 22:55:20,057] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),kafka-chat-2 -> (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 22:55:20,077] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=265, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=2, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:55:20,191] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:55:20,229] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:55:20,229] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:55:20,229] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:55:20,229] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:55:20,230] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:55:20,230] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:55:20,231] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:55:20,232] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:55:20,239] INFO [Controller id=2] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 22:55:20,239] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:55:20,239] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=265, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=2, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:55:20,240] TRACE [RequestSendThread controllerId=2] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:55:20,240] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:55:20,240] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:55:20,242] INFO [Controller id=2] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:55:20,243] INFO [Controller id=2] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:55:20,262] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:55:20,263] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 323, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:55:33,387] INFO [Controller id=2] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:55:33,387] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:55:33,390] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:55:33,390] INFO [Controller id=2] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 22:55:33,393] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:55:33,407] DEBUG [Controller id=2] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 22:55:33,408] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 323, 1 -> 378, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:55:33,427] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:55:33,445] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:55:33,498] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:55:33,609] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:55:33,751] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 22:55:33,754] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=2, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6). (kafka.controller.KafkaController)
[2025-01-16 22:55:33,763] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:55:33,765] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6). (kafka.controller.KafkaController)
[2025-01-16 22:55:44,312] INFO [Controller id=2] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 22:55:44,312] DEBUG [Controller id=2] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 22:55:44,312] DEBUG [Controller id=2] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-16 22:55:44,325] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-0 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),kafka-chat-1 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:7,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 22:55:44,338] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=323, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=2, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:55:44,454] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:55:44,543] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:55:44,543] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:55:44,543] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:55:44,544] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 22:55:44,544] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 22:55:44,545] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 22:55:44,545] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 22:55:44,546] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 22:55:44,553] INFO [Controller id=2] Newly added brokers: , deleted brokers: 0, bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-16 22:55:44,553] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 22:55:44,553] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=323, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=2, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:55:44,554] TRACE [RequestSendThread controllerId=2] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 22:55:44,554] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 22:55:44,554] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 22:55:44,555] INFO [Controller id=2] Broker failure callback for 0 (kafka.controller.KafkaController)
[2025-01-16 22:55:44,555] INFO [Controller id=2] Removed 0 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 22:55:44,577] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-16 22:55:44,577] INFO [Controller id=2] Updated broker epochs cache: HashMap(1 -> 378, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:56:02,320] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 22:56:02,320] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 22:56:02,323] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-16 22:56:02,323] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 22:56:02,326] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:56:02,337] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-16 22:56:02,338] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 433, 1 -> 378, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 22:56:02,360] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 22:56:02,373] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 22:56:02,443] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 22:56:02,551] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 22:56:02,700] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 22:56:02,703] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=1, leaderEpoch=4, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=8). (kafka.controller.KafkaController)
[2025-01-16 22:56:02,704] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 22:56:02,706] DEBUG [Controller id=2] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6). (kafka.controller.KafkaController)
[2025-01-16 22:59:17,544] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 22:59:17,544] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 22:59:17,545] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(kafka-chat-1 -> List(0, 1)) (kafka.controller.KafkaController)
[2025-01-16 22:59:17,545] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 22:59:17,545] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 2)) (kafka.controller.KafkaController)
[2025-01-16 22:59:17,545] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 22:59:17,545] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-16 22:59:17,545] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 23:02:14,227] INFO [Controller id=2] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 23:02:14,228] DEBUG [Controller id=2] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 23:02:14,228] DEBUG [Controller id=2] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-16 23:02:14,234] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),kafka-chat-0 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),kafka-chat-1 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:7,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-16 23:02:14,250] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=433, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=4, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=3, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 23:02:14,367] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 23:02:14,397] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 23:02:14,399] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 23:02:14,399] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 23:02:14,399] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 23:02:14,400] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 23:02:14,400] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:02:14,401] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:02:14,402] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 23:02:14,409] INFO [Controller id=2] Newly added brokers: , deleted brokers: 0, bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-16 23:02:14,409] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 23:02:14,409] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=2, brokerEpoch=433, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=4, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=3, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 23:02:14,410] TRACE [RequestSendThread controllerId=2] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 23:02:14,410] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 23:02:14,410] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 23:02:14,411] INFO [Controller id=2] Broker failure callback for 0 (kafka.controller.KafkaController)
[2025-01-16 23:02:14,412] INFO [Controller id=2] Removed 0 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 23:02:14,433] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-16 23:02:14,433] INFO [Controller id=2] Updated broker epochs cache: HashMap(1 -> 378, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 23:02:23,129] DEBUG [Controller id=2] Read current producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000), Zk path version 1 (kafka.controller.KafkaController)
[2025-01-16 23:02:23,133] INFO [Controller id=2] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=2, firstProducerId=1000, size=1000) by writing to Zk with path version 2 (kafka.controller.KafkaController)
[2025-01-16 23:02:23,237] DEBUG [Controller id=2] Read current producerId block ProducerIdsBlock(assignedBrokerId=2, firstProducerId=1000, size=1000), Zk path version 2 (kafka.controller.KafkaController)
[2025-01-16 23:02:23,239] INFO [Controller id=2] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=1, firstProducerId=2000, size=1000) by writing to Zk with path version 3 (kafka.controller.KafkaController)
[2025-01-16 23:02:32,606] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 23:02:32,606] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 23:02:32,609] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-16 23:02:32,609] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-16 23:02:32,613] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 23:02:32,623] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-16 23:02:32,624] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 490, 1 -> 378, 2 -> 211) (kafka.controller.KafkaController)
[2025-01-16 23:02:32,644] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 23:02:32,655] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 23:02:32,731] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 23:02:32,839] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 23:02:32,969] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 23:02:32,970] DEBUG [Controller id=2] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=4, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=8). (kafka.controller.KafkaController)
[2025-01-16 23:02:32,972] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 23:02:32,973] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=1, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=10). (kafka.controller.KafkaController)
[2025-01-16 23:04:17,546] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 23:04:17,546] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 23:04:17,548] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(kafka-chat-1 -> List(0, 1)) (kafka.controller.KafkaController)
[2025-01-16 23:04:17,548] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 23:04:17,548] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 2)) (kafka.controller.KafkaController)
[2025-01-16 23:04:17,548] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 23:04:17,549] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-16 23:04:17,549] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 23:06:59,057] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 23:06:59,058] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 23:06:59,059] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:06:59,061] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:06:59,064] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 23:06:59,124] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 3 and epoch zk version is now 3 (kafka.controller.KafkaController)
[2025-01-16 23:06:59,126] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 23:06:59,128] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 23:06:59,130] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 23:06:59,131] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 23:06:59,137] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 513, 1 -> 378) (kafka.controller.KafkaController)
[2025-01-16 23:06:59,146] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0, 1) (kafka.controller.KafkaController)
[2025-01-16 23:06:59,166] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 23:06:59,172] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 23:06:59,176] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,176] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,179] INFO [Controller id=0] Currently active brokers in the cluster: Set(0, 1) (kafka.controller.KafkaController)
[2025-01-16 23:06:59,179] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 23:06:59,180] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-16 23:06:59,180] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 23:06:59,184] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 23:06:59,184] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-16 23:06:59,184] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 23:06:59,185] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 23:06:59,185] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 23:06:59,195] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,195] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,196] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:06:59,200] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:06:59,218] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:06:59,249] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:06:59,250] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:06:59,252] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:06:59,280] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:06:59,280] INFO [Controller id=0] Ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2025-01-16 23:06:59,285] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 23:06:59,285] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 23:06:59,285] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 23:06:59,286] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 23:06:59,287] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 23:06:59,297] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 23:06:59,531] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 23:06:59,531] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-16 23:06:59,532] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:06:59,532] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:06:59,533] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,533] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,533] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,534] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,534] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,534] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,536] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,536] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,536] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,537] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 23:06:59,546] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 23:06:59,549] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 23:06:59,549] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 23:06:59,553] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,554] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 23:06:59,557] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 23:06:59,582] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 23:06:59,584] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 513, 1 -> 378, 2 -> 537) (kafka.controller.KafkaController)
[2025-01-16 23:06:59,590] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 23:06:59,593] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=9). (kafka.controller.KafkaController)
[2025-01-16 23:06:59,694] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 23:06:59,696] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=0, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=11). (kafka.controller.KafkaController)
[2025-01-16 23:07:04,302] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 23:07:04,302] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 23:07:04,313] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap(kafka-chat-1 -> List(0, 1)) (kafka.controller.KafkaController)
[2025-01-16 23:07:04,313] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-16 23:07:04,314] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-16 23:07:04,314] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 23:07:04,314] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(kafka-chat-2 -> List(2, 0)) (kafka.controller.KafkaController)
[2025-01-16 23:07:04,314] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.058823529411764705 (kafka.controller.KafkaController)
[2025-01-16 23:18:08,533] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-16 23:18:08,533] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-16 23:18:08,534] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:18:08,535] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:18:08,535] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,535] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,535] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,540] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,540] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,540] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,542] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,542] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,542] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,543] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-16 23:18:08,566] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 4 and epoch zk version is now 4 (kafka.controller.KafkaController)
[2025-01-16 23:18:08,567] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-16 23:18:08,570] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-16 23:18:08,572] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-16 23:18:08,573] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-16 23:18:08,577] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 560) (kafka.controller.KafkaController)
[2025-01-16 23:18:08,582] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-16 23:18:08,597] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-16 23:18:08,602] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-16 23:18:08,603] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-16 23:18:08,603] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-16 23:18:08,603] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-16 23:18:08,603] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,604] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-16 23:18:08,604] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-16 23:18:08,605] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-16 23:18:08,605] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-16 23:18:08,605] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-16 23:18:08,605] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:18:08,605] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:18:08,606] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 23:18:08,607] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:18:08,645] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:18:08,645] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:18:08,645] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:18:08,671] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OfflinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OfflinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:18:08,671] INFO [Controller id=0] Ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2025-01-16 23:18:08,672] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 23:18:08,673] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-16 23:18:08,673] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-16 23:18:08,673] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-16 23:18:08,673] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-16 23:18:08,675] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-16 23:18:09,019] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 23:18:09,019] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 23:18:09,019] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:18:09,019] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:18:09,019] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 23:18:09,041] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-16 23:18:09,042] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-16 23:18:09,043] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 23:18:09,045] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 23:18:09,045] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-16 23:18:09,048] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 23:18:09,075] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 23:18:09,076] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 560, 2 -> 602) (kafka.controller.KafkaController)
[2025-01-16 23:18:09,140] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-16 23:18:09,147] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 23:18:09,148] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:18:09,149] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:18:09,152] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-16 23:18:09,168] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-16 23:18:09,169] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-16 23:18:09,170] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-16 23:18:09,173] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-16 23:18:09,173] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-16 23:18:09,175] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-16 23:18:09,197] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-16 23:18:09,199] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 560, 1 -> 621, 2 -> 602) (kafka.controller.KafkaController)
[2025-01-16 23:18:09,212] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-16 23:18:09,214] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=7, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=13). (kafka.controller.KafkaController)
[2025-01-16 23:18:09,217] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-16 23:18:09,220] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=2, leaderEpoch=8, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=13). (kafka.controller.KafkaController)
[2025-01-16 23:18:10,161] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-16 23:18:10,175] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=0, leaderEpoch=7, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=13). (kafka.controller.KafkaController)
[2025-01-16 23:18:11,265] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-16 23:18:11,266] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-16 23:18:11,266] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 23:18:11,298] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),kafka-chat-1 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:13,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 23:18:11,319] WARN [RequestSendThread controllerId=0] Controller 0 epoch 4 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=4, brokerEpoch=602, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=7, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 23:18:11,431] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 23:18:11,525] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 23:18:11,525] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 23:18:11,525] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-16 23:18:11,525] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-16 23:18:11,525] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-16 23:18:11,525] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-16 23:18:11,525] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-16 23:18:11,525] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-16 23:18:11,533] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 23:18:11,533] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-16 23:18:11,533] WARN [RequestSendThread controllerId=0] Controller 0 epoch 4 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=4, brokerEpoch=602, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=7, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-16 23:18:11,534] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-16 23:18:11,534] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-16 23:18:11,534] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-16 23:18:11,537] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-16 23:18:11,537] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-16 23:18:11,557] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-16 23:18:11,557] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 560, 1 -> 621) (kafka.controller.KafkaController)
[2025-01-16 23:18:13,683] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-16 23:18:13,683] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-16 23:18:13,685] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-16 23:18:13,685] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 23:18:13,686] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-16 23:18:13,686] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-16 23:18:13,696] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-8 -> List(2), kafka-chat-2 -> List(2, 0), __consumer_offsets-35 -> List(2), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2)) (kafka.controller.KafkaController)
[2025-01-16 23:18:13,696] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-16 23:18:13,699] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-16 23:18:14,634] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 23:18:14,634] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-16 23:18:14,634] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2025-01-16 23:18:14,653] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 23:18:17,605] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-16 23:18:17,606] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 23:18:17,606] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 23:18:17,612] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-16 23:18:19,663] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-16 23:18:19,663] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-16 23:18:19,663] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-16 23:18:19,673] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4) (kafka.controller.KafkaController)
[2025-01-18 07:17:28,138] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:17:28,166] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 5 and epoch zk version is now 5 (kafka.controller.KafkaController)
[2025-01-18 07:17:28,167] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 07:17:28,170] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 07:17:28,172] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 07:17:28,174] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 07:17:28,184] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 696) (kafka.controller.KafkaController)
[2025-01-18 07:17:28,195] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-18 07:17:28,222] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:17:28,225] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:17:28,225] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-18 07:17:28,225] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:17:28,225] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 07:17:28,225] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 07:17:28,233] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 07:17:28,233] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 07:17:28,234] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 07:17:28,234] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 07:17:28,249] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 07:17:28,264] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:17:28,270] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:17:28,270] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:17:28,298] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:17:28,356] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:17:28,356] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:17:28,365] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:17:28,389] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:17:28,404] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OfflinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OfflinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:17:28,404] INFO [Controller id=0] Ready to serve as the new controller with epoch 5 (kafka.controller.KafkaController)
[2025-01-18 07:17:28,415] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:17:28,415] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:17:28,415] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:17:28,415] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 07:17:28,417] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 07:17:28,420] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 07:17:33,433] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:17:33,434] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:17:33,439] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:17:33,440] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:17:33,440] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(__consumer_offsets-30 -> List(1), __consumer_offsets-21 -> List(1), __consumer_offsets-33 -> List(1), __consumer_offsets-36 -> List(1), __consumer_offsets-48 -> List(1), kafka-chat-0 -> List(1, 2), __consumer_offsets-6 -> List(1), __consumer_offsets-0 -> List(1), __consumer_offsets-45 -> List(1), __consumer_offsets-27 -> List(1), __consumer_offsets-9 -> List(1), __consumer_offsets-42 -> List(1), __consumer_offsets-3 -> List(1), __consumer_offsets-18 -> List(1), __consumer_offsets-15 -> List(1), __consumer_offsets-24 -> List(1), __consumer_offsets-39 -> List(1), __consumer_offsets-12 -> List(1)) (kafka.controller.KafkaController)
[2025-01-18 07:17:33,440] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:17:33,441] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:17:33,442] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-8 -> List(2), kafka-chat-2 -> List(2, 0), __consumer_offsets-35 -> List(2), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2)) (kafka.controller.KafkaController)
[2025-01-18 07:17:33,442] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:17:33,442] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:17:39,979] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:17:39,979] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:17:39,983] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:17:39,984] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:17:39,987] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:17:40,014] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:17:40,015] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 696, 1 -> 748) (kafka.controller.KafkaController)
[2025-01-18 07:17:40,016] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:17:40,030] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:17:40,098] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:17:40,210] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:17:40,426] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 07:17:40,430] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=8, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=15). (kafka.controller.KafkaController)
[2025-01-18 07:17:46,641] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:17:46,641] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:17:46,644] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:17:46,644] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 07:17:46,647] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:17:46,661] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 07:17:46,662] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 696, 1 -> 748, 2 -> 783) (kafka.controller.KafkaController)
[2025-01-18 07:17:46,676] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:17:46,688] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:17:46,757] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:17:46,866] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:17:47,013] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 07:17:47,016] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=0, leaderEpoch=8, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=15). (kafka.controller.KafkaController)
[2025-01-18 07:17:47,042] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 07:17:47,045] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=11, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=17). (kafka.controller.KafkaController)
[2025-01-18 07:18:20,199] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 07:18:20,199] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:18:20,200] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 07:18:20,215] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),kafka-chat-0 -> (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:17,ControllerEpoch:5),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),kafka-chat-1 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:16,ControllerEpoch:5),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:16,ControllerEpoch:5),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5) (kafka.controller.KafkaController)
[2025-01-18 07:18:20,233] WARN [RequestSendThread controllerId=0] Controller 0 epoch 5 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=5, brokerEpoch=696, partitionStates=[LeaderAndIsrPartitionState(topicName='kafka-chat', partitionIndex=1, controllerEpoch=5, leader=1, leaderEpoch=9, isr=[1], partitionEpoch=16, replicas=[0, 1], addingReplicas=[], removingReplicas=[], isNew=false, leaderRecoveryState=0), LeaderAndIsrPartitionState(topicName='kafka-chat', partitionIndex=2, controllerEpoch=5, leader=2, leaderEpoch=9, isr=[2], partitionEpoch=16, replicas=[2, 0], addingReplicas=[], removingReplicas=[], isNew=false, leaderRecoveryState=0)], topicIds={kafka-chat=1QcDRAdsThSXtxu8ZQ90yw}, liveLeaders=(127.0.0.1:9094 (id: 2 rack: null), 127.0.0.1:9093 (id: 1 rack: null))) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:18:20,344] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:18:20,400] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:18:20,400] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:18:20,400] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:18:20,401] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:18:20,401] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:18:20,401] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:18:20,402] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:18:20,402] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,402] WARN [RequestSendThread controllerId=0] Controller 0 epoch 5 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=5, brokerEpoch=696, partitionStates=[LeaderAndIsrPartitionState(topicName='kafka-chat', partitionIndex=1, controllerEpoch=5, leader=1, leaderEpoch=9, isr=[1], partitionEpoch=16, replicas=[0, 1], addingReplicas=[], removingReplicas=[], isNew=false, leaderRecoveryState=0), LeaderAndIsrPartitionState(topicName='kafka-chat', partitionIndex=2, controllerEpoch=5, leader=2, leaderEpoch=9, isr=[2], partitionEpoch=16, replicas=[2, 0], addingReplicas=[], removingReplicas=[], isNew=false, leaderRecoveryState=0)], topicIds={kafka-chat=1QcDRAdsThSXtxu8ZQ90yw}, liveLeaders=(127.0.0.1:9094 (id: 2 rack: null), 127.0.0.1:9093 (id: 1 rack: null))) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:18:20,403] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,403] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,403] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,404] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,404] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,404] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,405] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,405] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,405] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,406] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:18:20,420] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 6 and epoch zk version is now 6 (kafka.controller.KafkaController)
[2025-01-18 07:18:20,422] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 07:18:20,424] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 07:18:20,424] DEBUG [Controller id=2] Broker 1 was elected as controller instead of broker 2 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-18 07:18:20,426] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 07:18:20,427] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 07:18:20,431] INFO [Controller id=1] Initialized broker epochs cache: HashMap(1 -> 748, 2 -> 783) (kafka.controller.KafkaController)
[2025-01-18 07:18:20,439] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:18:20,457] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:18:20,462] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:18:20,464] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,464] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,465] INFO [Controller id=1] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:18:20,465] INFO [Controller id=1] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:18:20,466] INFO [Controller id=1] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 07:18:20,466] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 07:18:20,469] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 07:18:20,469] INFO [Controller id=1] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 07:18:20,469] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 07:18:20,469] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 07:18:20,470] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 07:18:20,475] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,475] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:18:20,475] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:18:20,478] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:18:20,490] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:18:20,514] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:18:20,514] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:18:20,516] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:18:20,539] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:18:20,539] INFO [Controller id=1] Ready to serve as the new controller with epoch 6 (kafka.controller.KafkaController)
[2025-01-18 07:18:20,542] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:18:20,542] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:18:20,542] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:18:20,542] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 07:18:20,543] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 07:18:20,548] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 07:18:25,561] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:18:25,561] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:18:25,564] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-13 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-16 -> List(0), kafka-chat-1 -> List(0, 1), __consumer_offsets-28 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2025-01-18 07:18:25,565] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:18:25,567] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:18:25,567] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:18:25,567] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:18:25,567] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:18:25,567] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:19:06,381] INFO [Controller id=1] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:19:06,381] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:19:06,384] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:19:06,385] INFO [Controller id=1] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-18 07:19:06,390] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:19:06,406] DEBUG [Controller id=1] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 07:19:06,407] INFO [Controller id=1] Updated broker epochs cache: HashMap(0 -> 840, 1 -> 748, 2 -> 783) (kafka.controller.KafkaController)
[2025-01-18 07:19:06,420] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:19:06,433] DEBUG [Controller id=0] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:19:06,495] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:19:06,600] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:19:06,766] DEBUG [Controller id=1] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 07:19:06,770] DEBUG [Controller id=1] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=1, leaderEpoch=9, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=17). (kafka.controller.KafkaController)
[2025-01-18 07:19:06,776] DEBUG [Controller id=1] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 07:19:06,783] DEBUG [Controller id=1] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=9, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=17). (kafka.controller.KafkaController)
[2025-01-18 07:19:18,019] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:19:18,019] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 07:19:18,019] DEBUG [Controller id=1] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 07:19:18,028] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:18,ControllerEpoch:6),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:18,ControllerEpoch:6),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),kafka-chat-2 -> (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:17,ControllerEpoch:6),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5) (kafka.controller.KafkaController)
[2025-01-18 07:19:18,203] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:19:18,203] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:19:18,203] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:19:18,203] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:19:18,204] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:19:18,204] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:19:18,205] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:18,205] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,205] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,205] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,206] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,206] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,206] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,207] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,207] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,207] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,208] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:19:18,216] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 7 and epoch zk version is now 7 (kafka.controller.KafkaController)
[2025-01-18 07:19:18,217] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:19:18,217] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 07:19:18,219] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 07:19:18,220] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 07:19:18,221] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 07:19:18,224] INFO [Controller id=2] Initialized broker epochs cache: HashMap(0 -> 840, 2 -> 783) (kafka.controller.KafkaController)
[2025-01-18 07:19:18,231] DEBUG [Controller id=2] Register BrokerModifications handler for Set(0, 2) (kafka.controller.KafkaController)
[2025-01-18 07:19:18,246] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:19:18,251] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:19:18,253] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,253] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,254] INFO [Controller id=2] Currently active brokers in the cluster: Set(0, 2) (kafka.controller.KafkaController)
[2025-01-18 07:19:18,255] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:19:18,255] INFO [Controller id=2] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 07:19:18,255] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 07:19:18,257] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 07:19:18,258] INFO [Controller id=2] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 07:19:18,258] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 07:19:18,258] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 07:19:18,258] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 07:19:18,263] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,263] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:19:18,263] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:18,266] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:18,279] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:18,303] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:18,303] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:19:18,305] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:19:18,320] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OfflinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OfflinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OfflinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:19:18,320] INFO [Controller id=2] Ready to serve as the new controller with epoch 7 (kafka.controller.KafkaController)
[2025-01-18 07:19:18,322] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:19:18,322] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:19:18,323] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:19:18,323] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 07:19:18,323] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 07:19:18,328] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 07:19:23,341] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:19:23,341] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:19:23,345] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:19:23,347] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:19:23,347] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(__consumer_offsets-30 -> List(1), __consumer_offsets-21 -> List(1), __consumer_offsets-33 -> List(1), __consumer_offsets-36 -> List(1), __consumer_offsets-48 -> List(1), kafka-chat-0 -> List(1, 2), __consumer_offsets-6 -> List(1), __consumer_offsets-0 -> List(1), __consumer_offsets-45 -> List(1), __consumer_offsets-27 -> List(1), __consumer_offsets-9 -> List(1), __consumer_offsets-42 -> List(1), __consumer_offsets-3 -> List(1), __consumer_offsets-18 -> List(1), __consumer_offsets-15 -> List(1), __consumer_offsets-24 -> List(1), __consumer_offsets-39 -> List(1), __consumer_offsets-12 -> List(1)) (kafka.controller.KafkaController)
[2025-01-18 07:19:23,347] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:19:23,347] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:19:23,347] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:19:23,347] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:19:39,076] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 07:19:39,076] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-18 07:19:39,077] DEBUG [Controller id=2] Live brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:19:39,094] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-42 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-21 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:18,ControllerEpoch:7),__consumer_offsets-45 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-12 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:18,ControllerEpoch:7),__consumer_offsets-15 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-48 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-36 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:18,ControllerEpoch:7),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-39 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-6 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5) (kafka.controller.KafkaController)
[2025-01-18 07:19:39,519] INFO [Controller id=2] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:19:39,519] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:19:39,521] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:19:39,522] INFO [Controller id=2] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:19:39,526] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:19:39,541] DEBUG [Controller id=2] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:19:39,542] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 840, 1 -> 898, 2 -> 783) (kafka.controller.KafkaController)
[2025-01-18 07:19:39,554] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:19:39,564] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:19:39,635] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:19:39,741] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:19:39,924] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:39,924] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:39,929] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 07:19:39,934] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=10, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=19). (kafka.controller.KafkaController)
[2025-01-18 07:19:40,411] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:40,411] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:40,925] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:40,925] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:41,446] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:41,446] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:41,954] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:41,954] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:42,178] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:42,178] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:42,698] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:42,698] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:43,191] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:43,191] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:43,710] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:43,710] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:44,110] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 07:19:44,110] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-18 07:19:44,110] DEBUG [Controller id=2] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:19:44,115] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:18,ControllerEpoch:7),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),kafka-chat-1 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:19,ControllerEpoch:7),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:18,ControllerEpoch:7),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5) (kafka.controller.KafkaController)
[2025-01-18 07:19:44,203] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:44,203] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:44,723] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:44,723] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:45,211] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:45,211] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:45,730] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:45,730] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:46,238] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:46,238] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:46,752] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:46,752] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:47,230] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:47,230] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:47,744] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:47,745] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:48,243] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:48,243] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:48,755] INFO [Controller id=2] Rejecting AlterPartition request from node 2 for kafka-chat-0 because it specified ineligible replicas Set(2) in the new ISR List(2, 1). (kafka.controller.KafkaController)
[2025-01-18 07:19:48,755] DEBUG [Controller id=2] Updating ISRs for partitions: Set(). (kafka.controller.KafkaController)
[2025-01-18 07:19:49,123] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 07:19:49,123] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-18 07:19:49,123] DEBUG [Controller id=2] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:19:49,130] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:18,ControllerEpoch:7),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),kafka-chat-1 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:19,ControllerEpoch:7),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:18,ControllerEpoch:7),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:5) (kafka.controller.KafkaController)
[2025-01-18 07:19:49,294] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:19:49,295] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:19:49,295] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:19:49,295] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:19:49,295] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:19:49,296] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:19:49,297] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:49,297] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,297] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,297] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,298] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,298] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,298] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,299] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,299] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,299] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,300] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:19:49,310] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 8 and epoch zk version is now 8 (kafka.controller.KafkaController)
[2025-01-18 07:19:49,312] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 07:19:49,314] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 07:19:49,315] DEBUG [Controller id=1] Broker 0 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-18 07:19:49,316] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 07:19:49,317] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 07:19:49,321] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 840, 1 -> 898) (kafka.controller.KafkaController)
[2025-01-18 07:19:49,328] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0, 1) (kafka.controller.KafkaController)
[2025-01-18 07:19:49,344] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:19:49,350] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:19:49,353] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,353] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,354] INFO [Controller id=0] Currently active brokers in the cluster: Set(0, 1) (kafka.controller.KafkaController)
[2025-01-18 07:19:49,354] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:19:49,354] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 07:19:49,354] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 07:19:49,357] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 07:19:49,357] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 07:19:49,357] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 07:19:49,358] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 07:19:49,358] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 07:19:49,363] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,363] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:19:49,363] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:49,368] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:49,383] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:49,406] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:19:49,406] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:19:49,408] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:19:49,434] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OfflinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:19:49,435] INFO [Controller id=0] Ready to serve as the new controller with epoch 8 (kafka.controller.KafkaController)
[2025-01-18 07:19:49,438] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:19:49,438] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:19:49,439] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:19:49,439] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 07:19:49,439] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 07:19:49,446] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 07:19:54,447] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:19:54,447] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:19:54,451] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:19:54,452] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:19:54,452] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 2)) (kafka.controller.KafkaController)
[2025-01-18 07:19:54,452] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 07:19:54,452] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-8 -> List(2), kafka-chat-2 -> List(2, 0), __consumer_offsets-35 -> List(2), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2)) (kafka.controller.KafkaController)
[2025-01-18 07:19:54,452] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:19:54,453] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:24:29,754] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:24:29,754] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 07:24:29,754] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:24:29,763] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:19,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:20,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:18,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:24:29,781] WARN [RequestSendThread controllerId=0] Controller 0 epoch 8 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=8, brokerEpoch=898, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=13, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=10, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:29,892] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:29,935] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:24:29,935] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:24:29,935] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:24:29,936] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:24:29,936] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 07:24:29,936] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:24:29,937] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:24:29,938] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:24:29,946] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:24:29,947] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:24:29,947] WARN [RequestSendThread controllerId=0] Controller 0 epoch 8 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=8, brokerEpoch=898, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=13, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=10, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:29,948] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 07:24:29,948] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:24:29,948] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:24:29,951] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:24:29,951] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 07:24:29,982] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:24:29,983] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840) (kafka.controller.KafkaController)
[2025-01-18 07:24:35,680] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:24:35,680] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:24:35,683] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:24:35,683] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:24:35,686] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:35,704] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:24:35,704] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840, 1 -> 972) (kafka.controller.KafkaController)
[2025-01-18 07:24:35,717] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:24:35,730] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:24:35,792] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:35,896] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:24:36,040] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 07:24:36,042] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=11, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=21). (kafka.controller.KafkaController)
[2025-01-18 07:24:46,347] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:24:46,347] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 07:24:46,347] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:24:46,352] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:19,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:22,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:18,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:24:46,365] WARN [RequestSendThread controllerId=0] Controller 0 epoch 8 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=8, kraftController=false, type=UNKNOWN, brokerEpoch=972, partitionStates=[UpdateMetadataPartitionState(topicName='kafka-chat', partitionIndex=0, controllerEpoch=8, leader=-1, leaderEpoch=13, isr=[2], zkVersion=19, replicas=[1, 2], offlineReplicas=[1, 2]), UpdateMetadataPartitionState(topicName='kafka-chat', partitionIndex=1, controllerEpoch=8, leader=0, leaderEpoch=12, isr=[0], zkVersion=22, replicas=[0, 1], offlineReplicas=[1])], liveBrokers=UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:46,472] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:46,493] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:24:46,494] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:24:46,494] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:24:46,494] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:24:46,494] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 07:24:46,495] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:24:46,495] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:24:46,496] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:24:46,502] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:24:46,502] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:24:46,502] WARN [RequestSendThread controllerId=0] Controller 0 epoch 8 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=8, kraftController=false, type=UNKNOWN, brokerEpoch=972, partitionStates=[UpdateMetadataPartitionState(topicName='kafka-chat', partitionIndex=0, controllerEpoch=8, leader=-1, leaderEpoch=13, isr=[2], zkVersion=19, replicas=[1, 2], offlineReplicas=[1, 2]), UpdateMetadataPartitionState(topicName='kafka-chat', partitionIndex=1, controllerEpoch=8, leader=0, leaderEpoch=12, isr=[0], zkVersion=22, replicas=[0, 1], offlineReplicas=[1])], liveBrokers=UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:46,502] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 07:24:46,502] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:24:46,502] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:24:46,503] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:24:46,503] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 07:24:46,522] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:24:46,522] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840) (kafka.controller.KafkaController)
[2025-01-18 07:24:50,897] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:24:50,897] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:24:50,900] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:24:50,900] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:24:50,902] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:50,917] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:24:50,918] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840, 1 -> 1025) (kafka.controller.KafkaController)
[2025-01-18 07:24:50,933] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:24:50,945] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:24:51,007] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:24:51,113] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:24:51,243] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 07:24:51,245] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=12, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=23). (kafka.controller.KafkaController)
[2025-01-18 07:24:54,457] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:24:54,457] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:24:54,458] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:24:54,458] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:24:54,458] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(kafka-chat-0 -> List(1, 2)) (kafka.controller.KafkaController)
[2025-01-18 07:24:54,458] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 07:24:54,458] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-8 -> List(2), kafka-chat-2 -> List(2, 0), __consumer_offsets-35 -> List(2), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2)) (kafka.controller.KafkaController)
[2025-01-18 07:24:54,458] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:24:54,458] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:25:01,196] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:25:01,196] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:25:01,197] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 07:25:01,197] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:25:01,197] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:25:01,212] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 07:25:01,213] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840, 1 -> 1025, 2 -> 1059) (kafka.controller.KafkaController)
[2025-01-18 07:25:01,240] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:25:01,251] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:25:01,308] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:25:01,412] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:25:01,583] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 07:25:01,585] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=0, leaderEpoch=10, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=19). (kafka.controller.KafkaController)
[2025-01-18 07:25:02,292] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 07:25:02,295] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=2, leaderEpoch=14, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=21). (kafka.controller.KafkaController)
[2025-01-18 07:25:04,257] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:25:04,257] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 07:25:04,257] DEBUG [Controller id=0] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 07:25:04,261] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:22,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:24,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:19,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:25:04,273] WARN [RequestSendThread controllerId=0] Controller 0 epoch 8 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=8, brokerEpoch=1025, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=14, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=12, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:25:04,383] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:25:04,419] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:25:04,419] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:25:04,419] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:25:04,420] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:25:04,420] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 07:25:04,420] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:25:04,421] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:25:04,422] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:25:04,429] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 07:25:04,429] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:25:04,429] WARN [RequestSendThread controllerId=0] Controller 0 epoch 8 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=8, brokerEpoch=1025, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=14, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=12, deletePartition=false)])) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:25:04,430] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 07:25:04,430] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:25:04,430] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:25:04,431] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:25:04,431] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 07:25:04,448] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:25:04,448] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840, 2 -> 1059) (kafka.controller.KafkaController)
[2025-01-18 07:25:09,717] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:25:09,717] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:25:09,720] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:25:09,720] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:25:09,724] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:25:09,734] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:25:09,734] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840, 1 -> 1114, 2 -> 1059) (kafka.controller.KafkaController)
[2025-01-18 07:25:09,764] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:25:09,776] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:25:09,831] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:25:09,943] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:25:10,051] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:25:10,200] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 07:25:10,201] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=13, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=25). (kafka.controller.KafkaController)
[2025-01-18 07:25:10,202] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 07:25:10,204] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=2, leaderEpoch=15, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=23). (kafka.controller.KafkaController)
[2025-01-18 07:29:26,374] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 07:29:26,374] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-18 07:29:26,374] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:29:26,388] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:24,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:25,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:20,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:29:26,405] WARN [RequestSendThread controllerId=0] Controller 0 epoch 8 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=8, brokerEpoch=1059, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=10, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:29:26,511] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:29:26,615] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:26,615] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:26,615] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:26,616] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:29:26,616] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 07:29:26,616] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:29:26,617] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:29:26,617] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:29:26,618] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:29:26,625] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:29:26,625] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:29:26,625] WARN [RequestSendThread controllerId=0] Controller 0 epoch 8 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=8, brokerEpoch=1059, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=10, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:29:26,626] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 07:29:26,626] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:29:26,626] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:29:26,627] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-18 07:29:26,627] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 07:29:26,648] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 07:29:26,648] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840, 1 -> 1114) (kafka.controller.KafkaController)
[2025-01-18 07:29:27,249] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:29:27,249] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 07:29:27,249] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:29:27,254] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:24,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:26,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:20,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:29:28,026] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 07:29:28,026] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:29:28,026] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-18 07:29:28,027] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:24,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:26,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:20,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:29:32,273] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:29:32,273] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:29:32,273] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-18 07:29:32,273] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:24,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:26,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:20,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:29:33,031] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 07:29:33,031] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:29:33,031] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-18 07:29:33,033] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:24,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:26,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:20,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:29:37,283] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:29:37,283] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:29:37,283] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-18 07:29:37,291] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:24,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:26,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:20,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:29:37,436] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:37,436] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:37,436] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:37,436] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:29:37,437] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 07:29:37,437] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:29:37,438] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:29:37,439] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:29:37,445] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:29:37,445] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:29:37,445] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:29:37,445] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:29:37,446] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:29:37,446] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 07:29:37,464] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:29:37,464] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 840) (kafka.controller.KafkaController)
[2025-01-18 07:29:38,038] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 07:29:38,038] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:29:38,038] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2025-01-18 07:29:38,038] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-42 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-21 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-30 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),kafka-chat-0 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:25,ControllerEpoch:8),__consumer_offsets-45 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-12 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-24 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:26,ControllerEpoch:8),__consumer_offsets-15 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-48 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-36 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),kafka-chat-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:20,ControllerEpoch:8),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-39 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-6 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:8),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) (kafka.controller.KafkaController)
[2025-01-18 07:29:38,206] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:38,206] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:38,206] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:29:38,206] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:29:38,206] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-18 07:29:38,206] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:29:38,206] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:29:38,209] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:29:38,209] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:29:38,209] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:29:38,210] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:30:09,576] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:30:09,606] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2025-01-18 07:30:09,609] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2025-01-18 07:30:09,641] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 07:30:09,645] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 07:30:09,648] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 07:30:09,650] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 07:30:09,661] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2025-01-18 07:30:09,665] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-18 07:30:09,673] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:30:09,682] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:30:09,684] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-18 07:30:09,684] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:30:09,685] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:30:09,685] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 07:30:09,687] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 07:30:09,687] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:30:09,688] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 07:30:09,688] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-18 07:30:09,689] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 07:30:09,698] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:30:09,699] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:30:09,703] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:30:09,703] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:30:09,704] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:30:09,704] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:30:09,710] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:30:09,711] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2025-01-18 07:30:09,711] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:30:09,716] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:30:09,717] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:30:09,717] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:30:09,717] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 07:30:09,718] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 07:30:09,736] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 07:30:09,816] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:30:12,568] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:30:12,569] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:30:12,572] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:30:12,573] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:30:12,576] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:30:12,577] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:30:12,578] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45) (kafka.controller.KafkaController)
[2025-01-18 07:30:12,602] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:30:12,614] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:30:12,691] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:30:12,797] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:30:14,749] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:30:14,750] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:30:14,906] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:30:14,906] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:30:14,906] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:30:14,906] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 07:30:14,906] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 07:30:14,906] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 07:30:14,916] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:30:14,940] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:30:14,957] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:30:15,019] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:30:15,123] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:30:37,971] INFO [Controller id=0] New topics: [Set(kafka-chat)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(kafka-chat,Some(khLWI56kRUSmMzowhsIXZA),Map(kafka-chat-0 -> ReplicaAssignment(replicas=0,1, addingReplicas=, removingReplicas=), kafka-chat-1 -> ReplicaAssignment(replicas=2,0, addingReplicas=, removingReplicas=), kafka-chat-2 -> ReplicaAssignment(replicas=1,2, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-18 07:30:37,971] INFO [Controller id=0] New partition creation callback for kafka-chat-0,kafka-chat-1,kafka-chat-2 (kafka.controller.KafkaController)
[2025-01-18 07:30:47,046] INFO [Controller id=0] New topics: [Set(__consumer_offsets)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(__consumer_offsets,Some(d5RXmrD2TvqbHCkJ2YabLw),HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-18 07:30:47,047] INFO [Controller id=0] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2025-01-18 07:31:33,075] DEBUG [Controller id=0] There is no producerId block yet (Zk path version 0), creating the first block (kafka.controller.KafkaController)
[2025-01-18 07:31:33,080] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=2, firstProducerId=0, size=1000) by writing to Zk with path version 1 (kafka.controller.KafkaController)
[2025-01-18 07:31:33,193] DEBUG [Controller id=0] Read current producerId block ProducerIdsBlock(assignedBrokerId=2, firstProducerId=0, size=1000), Zk path version 1 (kafka.controller.KafkaController)
[2025-01-18 07:31:33,196] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=1, firstProducerId=1000, size=1000) by writing to Zk with path version 2 (kafka.controller.KafkaController)
[2025-01-18 07:31:55,325] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 07:31:55,325] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:31:55,326] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 07:31:55,370] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-2 -> (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-18 07:31:55,390] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=25, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:31:55,505] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:31:55,564] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:31:55,565] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:31:55,565] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:31:55,565] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:31:55,565] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:31:55,566] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:31:55,566] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:31:55,567] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,567] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=25, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:31:55,568] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,568] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,568] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,569] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,569] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,569] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,570] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,570] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,570] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,571] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:31:55,589] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2025-01-18 07:31:55,591] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 07:31:55,593] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 07:31:55,593] DEBUG [Controller id=1] Broker 2 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-18 07:31:55,595] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 07:31:55,596] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 07:31:55,600] INFO [Controller id=2] Initialized broker epochs cache: HashMap(1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 07:31:55,609] DEBUG [Controller id=2] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:31:55,624] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:31:55,629] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:31:55,632] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,632] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,633] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:31:55,633] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:31:55,634] INFO [Controller id=2] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 07:31:55,634] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 07:31:55,636] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 07:31:55,637] INFO [Controller id=2] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 07:31:55,637] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 07:31:55,637] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 07:31:55,637] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 07:31:55,642] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,642] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:31:55,643] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:31:55,645] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:31:55,659] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:31:55,688] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:31:55,688] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:31:55,691] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:31:55,715] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:31:55,715] INFO [Controller id=2] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2025-01-18 07:31:55,718] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:31:55,718] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:31:55,718] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:31:55,719] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 07:31:55,719] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 07:31:55,725] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 07:32:00,729] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:32:00,730] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:32:00,740] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-19 -> List(0), kafka-chat-0 -> List(0, 1), __consumer_offsets-10 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2025-01-18 07:32:00,742] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:32:00,744] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:32:00,744] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:32:00,744] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:32:00,744] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:32:00,744] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:32:55,103] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:32:55,103] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:32:55,106] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:32:55,107] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-18 07:32:55,111] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:32:55,128] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 07:32:55,129] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 216, 1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 07:32:55,142] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:32:55,152] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:32:55,216] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:32:55,323] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:32:55,524] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 07:32:55,528] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-18 07:32:55,536] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 07:32:55,539] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=2, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-18 07:32:59,085] INFO [Controller id=2] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:32:59,085] DEBUG [Controller id=2] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 07:32:59,086] DEBUG [Controller id=2] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 07:32:59,094] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-1 -> (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-18 07:32:59,267] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:32:59,267] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:32:59,268] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:32:59,268] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:32:59,268] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 07:32:59,268] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:32:59,269] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:32:59,270] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:32:59,276] INFO [Controller id=2] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 07:32:59,277] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:32:59,277] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:32:59,277] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:32:59,279] INFO [Controller id=2] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:32:59,280] INFO [Controller id=2] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 07:32:59,303] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:32:59,304] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 216, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 07:33:08,939] INFO [Controller id=2] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:33:08,939] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:33:08,942] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:33:08,943] INFO [Controller id=2] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 07:33:08,946] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:33:08,957] DEBUG [Controller id=2] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 07:33:08,958] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 216, 1 -> 271, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 07:33:08,976] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:33:08,988] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:33:09,053] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:33:09,161] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:33:09,310] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 07:33:09,312] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=0, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-18 07:33:09,321] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 07:33:09,323] DEBUG [Controller id=2] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-18 07:33:10,535] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 07:33:10,535] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-18 07:33:10,535] DEBUG [Controller id=2] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 07:33:10,543] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-0 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-18 07:33:10,708] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:33:10,708] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:33:10,708] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:33:10,708] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:33:10,708] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:33:10,708] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:33:10,709] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:10,709] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,709] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,709] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,710] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,710] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,710] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,711] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,712] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,712] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,713] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:33:10,731] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 3 and epoch zk version is now 3 (kafka.controller.KafkaController)
[2025-01-18 07:33:10,734] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 07:33:10,736] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 07:33:10,735] DEBUG [Controller id=1] Broker 0 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-18 07:33:10,739] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 07:33:10,740] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 07:33:10,744] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 216, 1 -> 271) (kafka.controller.KafkaController)
[2025-01-18 07:33:10,751] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0, 1) (kafka.controller.KafkaController)
[2025-01-18 07:33:10,765] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:33:10,770] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:33:10,772] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,772] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,774] INFO [Controller id=0] Currently active brokers in the cluster: Set(0, 1) (kafka.controller.KafkaController)
[2025-01-18 07:33:10,774] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:33:10,774] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 07:33:10,774] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 07:33:10,777] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 07:33:10,778] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 07:33:10,778] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 07:33:10,778] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 07:33:10,778] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 07:33:10,784] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,784] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:33:10,784] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:10,787] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:10,800] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:10,831] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:10,831] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:33:10,835] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:33:10,860] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:33:10,860] INFO [Controller id=0] Ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2025-01-18 07:33:10,863] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:33:10,863] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:33:10,863] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:33:10,863] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 07:33:10,864] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 07:33:10,869] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 07:33:15,875] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:33:15,876] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:33:15,879] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:33:15,879] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:33:15,880] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:33:15,880] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:33:15,880] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-47 -> List(2), kafka-chat-1 -> List(2, 0), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2)) (kafka.controller.KafkaController)
[2025-01-18 07:33:15,880] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:33:15,881] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:33:32,289] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 07:33:32,289] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:33:32,292] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:33:32,293] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 07:33:32,298] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:33:32,312] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 07:33:32,313] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 216, 1 -> 271, 2 -> 328) (kafka.controller.KafkaController)
[2025-01-18 07:33:32,321] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:33:32,334] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:33:32,412] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 07:33:32,520] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:33:32,677] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 07:33:32,680] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-18 07:33:32,689] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 07:33:32,692] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-18 07:33:56,874] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 07:33:56,874] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 07:33:56,874] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 07:33:56,896] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3) (kafka.controller.KafkaController)
[2025-01-18 07:33:57,067] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:33:57,067] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:33:57,067] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:33:57,068] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:33:57,068] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:33:57,068] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:33:57,069] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:57,069] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,069] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,069] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,070] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,070] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,070] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,072] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,072] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,072] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,074] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:33:57,090] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 4 and epoch zk version is now 4 (kafka.controller.KafkaController)
[2025-01-18 07:33:57,090] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 07:33:57,092] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 07:33:57,094] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 07:33:57,095] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 07:33:57,097] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 07:33:57,101] INFO [Controller id=1] Initialized broker epochs cache: HashMap(1 -> 271, 2 -> 328) (kafka.controller.KafkaController)
[2025-01-18 07:33:57,110] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:33:57,126] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:33:57,132] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 07:33:57,135] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,135] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,136] INFO [Controller id=1] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 07:33:57,136] INFO [Controller id=1] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 07:33:57,136] INFO [Controller id=1] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 07:33:57,137] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 07:33:57,140] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 07:33:57,140] INFO [Controller id=1] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 07:33:57,140] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 07:33:57,140] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 07:33:57,141] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 07:33:57,146] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,146] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 07:33:57,146] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:57,148] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:57,161] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:57,183] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:33:57,184] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:33:57,186] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:33:57,204] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:33:57,204] INFO [Controller id=1] Ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2025-01-18 07:33:57,207] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:33:57,207] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 07:33:57,207] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 07:33:57,208] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 07:33:57,209] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 07:33:57,214] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 07:34:02,219] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 07:34:02,220] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 07:34:02,225] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-19 -> List(0), kafka-chat-0 -> List(0, 1), __consumer_offsets-10 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2025-01-18 07:34:02,226] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 07:34:02,227] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 07:34:02,227] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:34:02,227] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:34:02,227] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 07:34:02,227] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 07:34:37,254] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 07:34:37,254] DEBUG [Controller id=1] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-18 07:34:37,254] DEBUG [Controller id=1] Live brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 07:34:37,271] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-1 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-49 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-25 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-37 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-19 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-28 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-43 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3) (kafka.controller.KafkaController)
[2025-01-18 07:34:38,241] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 07:34:38,241] DEBUG [Controller id=1] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 07:34:38,241] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2025-01-18 07:34:38,243] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-1 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-34 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-16 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-49 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-25 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-37 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-19 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-28 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:4),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-43 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-10 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-22 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3) (kafka.controller.KafkaController)
[2025-01-18 07:34:42,286] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 07:34:42,286] DEBUG [Controller id=1] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 07:34:42,286] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2025-01-18 07:35:47,447] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:35:47,447] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:35:47,447] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 07:35:47,447] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-18 07:35:47,447] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 07:35:47,447] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 07:35:47,447] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 07:35:47,447] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-18 07:36:18,452] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:52:15,416] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:52:15,433] DEBUG [Controller id=0] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 18:52:29,741] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 5 and epoch zk version is now 5 (kafka.controller.KafkaController)
[2025-01-18 18:52:29,743] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 18:52:29,746] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 18:52:29,748] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 18:52:29,750] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 18:52:29,758] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 385) (kafka.controller.KafkaController)
[2025-01-18 18:52:29,767] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-18 18:52:29,792] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 18:52:29,800] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 18:52:29,802] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-18 18:52:29,802] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 18:52:29,802] INFO [Controller id=0] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 18:52:29,803] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 18:52:29,808] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 18:52:29,809] INFO [Controller id=0] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 18:52:29,809] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 18:52:29,810] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 18:52:29,811] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 18:52:29,824] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:52:29,830] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:52:29,832] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 18:52:29,853] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:52:29,929] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:52:29,930] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:52:29,933] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:52:30,017] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OfflinePartition, kafka-chat-1 -> OfflinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, kafka-chat-2 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OfflinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:52:30,017] INFO [Controller id=0] Ready to serve as the new controller with epoch 5 (kafka.controller.KafkaController)
[2025-01-18 18:52:30,021] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 18:52:30,022] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 18:52:30,022] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 18:52:30,022] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 18:52:30,024] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 18:52:30,033] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 18:52:35,048] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 18:52:35,048] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 18:52:35,058] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap(kafka-chat-0 -> List(0, 1)) (kafka.controller.KafkaController)
[2025-01-18 18:52:35,059] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 18:52:35,059] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(__consumer_offsets-30 -> List(1), __consumer_offsets-21 -> List(1), kafka-chat-2 -> List(1, 2), __consumer_offsets-33 -> List(1), __consumer_offsets-36 -> List(1), __consumer_offsets-48 -> List(1), __consumer_offsets-6 -> List(1), __consumer_offsets-0 -> List(1), __consumer_offsets-45 -> List(1), __consumer_offsets-27 -> List(1), __consumer_offsets-9 -> List(1), __consumer_offsets-42 -> List(1), __consumer_offsets-3 -> List(1), __consumer_offsets-18 -> List(1), __consumer_offsets-15 -> List(1), __consumer_offsets-24 -> List(1), __consumer_offsets-39 -> List(1), __consumer_offsets-12 -> List(1)) (kafka.controller.KafkaController)
[2025-01-18 18:52:35,059] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 18:52:35,060] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 18:52:35,060] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(__consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-47 -> List(2), kafka-chat-1 -> List(2, 0), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2)) (kafka.controller.KafkaController)
[2025-01-18 18:52:35,060] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 18:52:35,060] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 18:52:35,928] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 18:52:35,928] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 18:52:35,932] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 18:52:35,932] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 18:52:35,942] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:52:35,971] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 18:52:35,973] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 385, 1 -> 509) (kafka.controller.KafkaController)
[2025-01-18 18:52:35,978] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:52:35,996] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 18:52:36,062] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:52:36,181] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:52:36,290] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 18:52:37,117] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 18:52:37,119] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=8). (kafka.controller.KafkaController)
[2025-01-18 18:52:41,195] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 18:52:41,195] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 18:52:41,198] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 18:52:41,198] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 18:52:41,201] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:52:41,216] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 18:52:41,217] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 385, 1 -> 509, 2 -> 545) (kafka.controller.KafkaController)
[2025-01-18 18:52:41,241] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:52:41,257] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 18:52:41,318] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:52:41,428] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 18:52:41,632] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 18:52:41,635] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=8). (kafka.controller.KafkaController)
[2025-01-18 18:52:42,263] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 18:52:42,266] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=2, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=8). (kafka.controller.KafkaController)
[2025-01-18 18:56:07,174] DEBUG [Controller id=0] Read current producerId block ProducerIdsBlock(assignedBrokerId=1, firstProducerId=1000, size=1000), Zk path version 2 (kafka.controller.KafkaController)
[2025-01-18 18:56:07,180] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=2000, size=1000) by writing to Zk with path version 3 (kafka.controller.KafkaController)
[2025-01-18 18:56:42,286] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 18:56:42,286] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 18:56:42,287] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 18:56:42,296] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:9,ControllerEpoch:5),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),kafka-chat-2 -> (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:8,ControllerEpoch:5),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) (kafka.controller.KafkaController)
[2025-01-18 18:56:42,312] WARN [RequestSendThread controllerId=0] Controller 0 epoch 5 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=5, brokerEpoch=385, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=5, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=5, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:56:42,419] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:56:42,468] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:56:42,468] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:56:42,468] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:56:42,468] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 18:56:42,469] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 18:56:42,469] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:56:42,470] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:56:42,470] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,471] WARN [RequestSendThread controllerId=0] Controller 0 epoch 5 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=5, brokerEpoch=385, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=5, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=5, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:56:42,471] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,471] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,471] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,472] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,472] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,472] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,473] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,473] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,473] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,475] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 18:56:42,492] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 6 and epoch zk version is now 6 (kafka.controller.KafkaController)
[2025-01-18 18:56:42,494] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 18:56:42,498] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 18:56:42,499] DEBUG [Controller id=1] Broker 2 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-18 18:56:42,501] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 18:56:42,503] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 18:56:42,509] INFO [Controller id=2] Initialized broker epochs cache: HashMap(1 -> 509, 2 -> 545) (kafka.controller.KafkaController)
[2025-01-18 18:56:42,518] DEBUG [Controller id=2] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 18:56:42,537] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 18:56:42,546] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 18:56:42,550] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,550] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,551] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 18:56:42,551] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 18:56:42,551] INFO [Controller id=2] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 18:56:42,551] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 18:56:42,554] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 18:56:42,554] INFO [Controller id=2] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 18:56:42,554] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 18:56:42,555] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 18:56:42,555] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 18:56:42,562] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,562] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 18:56:42,562] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:56:42,565] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:56:42,589] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:56:42,631] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:56:42,631] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:56:42,634] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:56:42,656] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:56:42,657] INFO [Controller id=2] Ready to serve as the new controller with epoch 6 (kafka.controller.KafkaController)
[2025-01-18 18:56:42,661] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 18:56:42,661] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 18:56:42,661] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 18:56:42,662] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 18:56:42,663] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 18:56:42,669] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 18:56:47,676] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 18:56:47,676] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 18:56:47,679] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-19 -> List(0), kafka-chat-0 -> List(0, 1), __consumer_offsets-10 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2025-01-18 18:56:47,680] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 18:56:47,681] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 18:56:47,681] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-18 18:56:47,681] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 18:56:47,681] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 18:56:47,681] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 18:57:59,062] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 18:57:59,063] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 18:57:59,066] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 18:57:59,067] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-18 18:57:59,072] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:57:59,089] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 18:57:59,090] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 604, 1 -> 509, 2 -> 545) (kafka.controller.KafkaController)
[2025-01-18 18:57:59,104] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:57:59,118] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 18:57:59,183] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:57:59,289] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:57:59,394] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 18:57:59,573] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 18:57:59,576] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=10). (kafka.controller.KafkaController)
[2025-01-18 18:57:59,585] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 18:57:59,588] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=2, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=10). (kafka.controller.KafkaController)
[2025-01-18 18:58:17,584] INFO [Controller id=2] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 18:58:17,584] DEBUG [Controller id=2] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 18:58:17,584] DEBUG [Controller id=2] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 18:58:17,592] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:11,ControllerEpoch:6),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),kafka-chat-1 -> (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:10,ControllerEpoch:6),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:9,ControllerEpoch:6),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) (kafka.controller.KafkaController)
[2025-01-18 18:58:17,782] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:58:17,782] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:58:17,782] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:58:17,783] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 18:58:17,783] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 18:58:17,784] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:58:17,784] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:58:17,785] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 18:58:17,793] INFO [Controller id=2] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 18:58:17,793] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 18:58:17,793] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 18:58:17,793] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 18:58:17,796] INFO [Controller id=2] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-18 18:58:17,797] INFO [Controller id=2] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 18:58:17,824] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 18:58:17,825] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 604, 2 -> 545) (kafka.controller.KafkaController)
[2025-01-18 18:58:44,273] INFO [Controller id=2] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 18:58:44,273] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 18:58:44,277] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 18:58:44,277] INFO [Controller id=2] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 18:58:44,279] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:58:44,291] DEBUG [Controller id=2] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 18:58:44,292] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 604, 1 -> 659, 2 -> 545) (kafka.controller.KafkaController)
[2025-01-18 18:58:44,317] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:58:44,330] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 18:58:44,388] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:58:44,495] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:58:44,605] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 18:58:44,768] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 18:58:44,770] DEBUG [Controller id=2] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=10). (kafka.controller.KafkaController)
[2025-01-18 18:58:44,780] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 18:58:44,782] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=0, leaderEpoch=7, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=12). (kafka.controller.KafkaController)
[2025-01-18 18:58:47,352] INFO [Controller id=2] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 18:58:47,353] DEBUG [Controller id=2] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 18:58:47,353] DEBUG [Controller id=2] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 18:58:47,371] TRACE [Controller id=2] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:13,ControllerEpoch:6),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:11,ControllerEpoch:6),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),kafka-chat-2 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:10,ControllerEpoch:6),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) (kafka.controller.KafkaController)
[2025-01-18 18:58:47,388] WARN [RequestSendThread controllerId=2] Controller 2 epoch 6 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=6, brokerEpoch=604, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=6, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:58:47,499] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:58:47,574] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:58:47,574] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:58:47,574] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:58:47,575] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 18:58:47,575] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 18:58:47,576] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 18:58:47,577] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 18:58:47,578] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 18:58:47,585] INFO [Controller id=2] Newly added brokers: , deleted brokers: 0, bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 18:58:47,585] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 18:58:47,585] WARN [RequestSendThread controllerId=2] Controller 2 epoch 6 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=6, brokerEpoch=604, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=6, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:58:47,586] TRACE [RequestSendThread controllerId=2] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 18:58:47,586] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 18:58:47,586] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 18:58:47,587] INFO [Controller id=2] Broker failure callback for 0 (kafka.controller.KafkaController)
[2025-01-18 18:58:47,587] INFO [Controller id=2] Removed 0 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 18:58:47,609] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 18:58:47,609] INFO [Controller id=2] Updated broker epochs cache: HashMap(1 -> 659, 2 -> 545) (kafka.controller.KafkaController)
[2025-01-18 18:59:01,300] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 18:59:01,300] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 18:59:01,303] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-18 18:59:01,303] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 18:59:01,307] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:59:01,322] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 18:59:01,324] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 714, 1 -> 659, 2 -> 545) (kafka.controller.KafkaController)
[2025-01-18 18:59:01,350] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 18:59:01,366] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 18:59:01,414] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:59:01,530] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 18:59:01,646] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 18:59:01,817] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 18:59:01,819] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=2, leaderEpoch=7, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=12). (kafka.controller.KafkaController)
[2025-01-18 18:59:01,909] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 18:59:01,912] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=8, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=14). (kafka.controller.KafkaController)
[2025-01-18 19:01:47,685] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:01:47,686] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:01:47,687] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(kafka-chat-0 -> List(0, 1)) (kafka.controller.KafkaController)
[2025-01-18 19:01:47,687] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 19:01:47,687] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(kafka-chat-2 -> List(1, 2)) (kafka.controller.KafkaController)
[2025-01-18 19:01:47,687] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 19:01:47,688] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 19:01:47,688] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:06:47,694] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:06:47,694] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:06:47,698] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(kafka-chat-0 -> List(0, 1)) (kafka.controller.KafkaController)
[2025-01-18 19:06:47,699] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 19:06:47,699] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(kafka-chat-2 -> List(1, 2)) (kafka.controller.KafkaController)
[2025-01-18 19:06:47,699] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 19:06:47,699] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 19:06:47,699] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:11:47,700] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:11:47,700] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:11:47,701] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(kafka-chat-0 -> List(0, 1)) (kafka.controller.KafkaController)
[2025-01-18 19:11:47,701] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 19:11:47,701] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(kafka-chat-2 -> List(1, 2)) (kafka.controller.KafkaController)
[2025-01-18 19:11:47,701] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 19:11:47,702] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 19:11:47,702] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:15:02,040] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:15:02,095] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 7 and epoch zk version is now 7 (kafka.controller.KafkaController)
[2025-01-18 19:15:02,098] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 19:15:02,106] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 19:15:02,110] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 19:15:02,114] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 19:15:02,131] INFO [Controller id=1] Initialized broker epochs cache: HashMap(0 -> 714, 1 -> 783) (kafka.controller.KafkaController)
[2025-01-18 19:15:02,156] DEBUG [Controller id=1] Register BrokerModifications handler for Set(0, 1) (kafka.controller.KafkaController)
[2025-01-18 19:15:02,207] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:15:02,220] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:15:02,236] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:15:02,237] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:15:02,261] INFO [Controller id=1] Currently active brokers in the cluster: Set(0, 1) (kafka.controller.KafkaController)
[2025-01-18 19:15:02,273] INFO [Controller id=1] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 19:15:02,274] INFO [Controller id=1] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 19:15:02,274] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 19:15:02,296] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 19:15:02,296] INFO [Controller id=1] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 19:15:02,297] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 19:15:02,298] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 19:15:02,304] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 19:15:02,354] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:15:02,372] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:15:02,393] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:02,393] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:02,512] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:15:02,513] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:02,513] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:02,593] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:15:02,593] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:15:02,598] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:15:02,635] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:15:02,638] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:02,684] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OfflinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OfflinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:15:02,684] INFO [Controller id=1] Ready to serve as the new controller with epoch 7 (kafka.controller.KafkaController)
[2025-01-18 19:15:02,707] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:15:02,707] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:15:02,707] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 19:15:02,708] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 19:15:02,710] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 19:15:02,723] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 19:15:02,782] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:02,904] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,031] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,145] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,252] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,358] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,464] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,570] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,603] INFO [Controller id=1] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:15:03,603] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:15:03,608] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:15:03,609] INFO [Controller id=1] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 19:15:03,614] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,637] DEBUG [Controller id=1] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 19:15:03,638] INFO [Controller id=1] Updated broker epochs cache: HashMap(0 -> 714, 1 -> 783, 2 -> 806) (kafka.controller.KafkaController)
[2025-01-18 19:15:03,654] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:15:03,669] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:15:03,677] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,724] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,786] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,831] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,913] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:03,946] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,030] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,061] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:15:04,141] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,253] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,288] DEBUG [Controller id=1] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 19:15:04,292] DEBUG [Controller id=1] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=8, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=13). (kafka.controller.KafkaController)
[2025-01-18 19:15:04,363] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,470] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,580] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,688] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,795] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:04,902] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,007] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,118] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,225] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,333] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,439] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,548] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,657] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,691] INFO [Controller id=1] Newly added brokers: , deleted brokers: 0, bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 19:15:05,692] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:15:05,692] WARN [RequestSendThread controllerId=1] Controller 1 epoch 7 fails to send request (type: UpdateMetadataRequest=, controllerId=1, controllerEpoch=7, kraftController=false, type=UNKNOWN, brokerEpoch=714, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:05,693] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 19:15:05,694] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:15:05,694] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:15:05,697] INFO [Controller id=1] Broker failure callback for 0 (kafka.controller.KafkaController)
[2025-01-18 19:15:05,723] DEBUG [Controller id=1] Unregister BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 19:15:05,723] INFO [Controller id=1] Updated broker epochs cache: HashMap(1 -> 783, 2 -> 806) (kafka.controller.KafkaController)
[2025-01-18 19:15:07,729] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:15:07,729] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:15:07,732] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-19 -> List(0), kafka-chat-0 -> List(0, 1), __consumer_offsets-10 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2025-01-18 19:15:07,734] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 19:15:07,735] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 19:15:07,735] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-18 19:15:07,735] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:15:07,740] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(kafka-chat-1 -> List(2, 0)) (kafka.controller.KafkaController)
[2025-01-18 19:15:07,740] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.058823529411764705 (kafka.controller.KafkaController)
[2025-01-18 19:15:14,389] INFO [Controller id=1] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:15:14,389] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:15:14,394] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:15:14,394] INFO [Controller id=1] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-18 19:15:14,400] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:14,420] DEBUG [Controller id=1] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 19:15:14,421] INFO [Controller id=1] Updated broker epochs cache: HashMap(0 -> 859, 1 -> 783, 2 -> 806) (kafka.controller.KafkaController)
[2025-01-18 19:15:14,451] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:15:14,468] DEBUG [Controller id=0] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:15:14,514] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:14,623] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:14,726] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:15:14,937] DEBUG [Controller id=1] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 19:15:14,939] DEBUG [Controller id=1] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=9, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=16). (kafka.controller.KafkaController)
[2025-01-18 19:15:15,479] DEBUG [Controller id=1] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 19:15:15,481] DEBUG [Controller id=1] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=11, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=17). (kafka.controller.KafkaController)
[2025-01-18 19:15:18,149] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 19:15:18,149] DEBUG [Controller id=1] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-18 19:15:18,150] DEBUG [Controller id=1] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 19:15:18,164] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),kafka-chat-0 -> (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:16,ControllerEpoch:7),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:18,ControllerEpoch:7),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:14,ControllerEpoch:7),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) (kafka.controller.KafkaController)
[2025-01-18 19:15:18,202] WARN [RequestSendThread controllerId=1] Controller 1 epoch 7 fails to send request (type=StopReplicaRequest, controllerId=1, controllerEpoch=7, brokerEpoch=806, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=11, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=8, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:18,309] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:18,422] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:18,493] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:15:18,494] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:15:18,494] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:15:18,494] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-18 19:15:18,494] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 19:15:18,495] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:15:18,496] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:15:18,498] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-18 19:15:18,510] INFO [Controller id=1] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 19:15:18,510] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:15:18,510] WARN [RequestSendThread controllerId=1] Controller 1 epoch 7 fails to send request (type=StopReplicaRequest, controllerId=1, controllerEpoch=7, brokerEpoch=806, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=11, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=8, deletePartition=false)])) to broker 127.0.0.1:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:18,511] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 19:15:18,511] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:15:18,512] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:15:18,514] INFO [Controller id=1] Broker failure callback for 2 (kafka.controller.KafkaController)
[2025-01-18 19:15:18,515] INFO [Controller id=1] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 19:15:18,548] DEBUG [Controller id=1] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 19:15:18,549] INFO [Controller id=1] Updated broker epochs cache: HashMap(0 -> 859, 1 -> 783) (kafka.controller.KafkaController)
[2025-01-18 19:15:24,828] INFO [Controller id=1] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:15:24,828] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:15:24,834] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:15:24,834] INFO [Controller id=1] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 19:15:24,839] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:24,854] DEBUG [Controller id=1] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 19:15:24,855] INFO [Controller id=1] Updated broker epochs cache: HashMap(0 -> 859, 1 -> 783, 2 -> 914) (kafka.controller.KafkaController)
[2025-01-18 19:15:24,891] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:15:24,909] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:15:24,948] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:25,056] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:25,166] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:15:25,272] INFO [RequestSendThread controllerId=1] Controller 1 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:15:25,484] DEBUG [Controller id=1] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 19:15:25,487] DEBUG [Controller id=1] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=9, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=15). (kafka.controller.KafkaController)
[2025-01-18 19:15:25,493] DEBUG [Controller id=1] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 19:15:25,496] DEBUG [Controller id=1] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=12, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=19). (kafka.controller.KafkaController)
[2025-01-18 19:16:03,751] INFO [Controller id=1] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 19:16:03,752] DEBUG [Controller id=1] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 19:16:03,752] DEBUG [Controller id=1] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 19:16:03,764] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:17,ControllerEpoch:7),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:20,ControllerEpoch:7),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),kafka-chat-2 -> (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:15,ControllerEpoch:7),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:7),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:7) (kafka.controller.KafkaController)
[2025-01-18 19:16:03,787] WARN [RequestSendThread controllerId=1] Controller 1 epoch 7 fails to send request (type=StopReplicaRequest, controllerId=1, controllerEpoch=7, brokerEpoch=859, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=9, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:16:03,896] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:16:04,005] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:16:04,038] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:16:04,038] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:16:04,038] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:16:04,039] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 19:16:04,039] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 19:16:04,040] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:16:04,041] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:16:04,043] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 19:16:04,051] INFO [Controller id=1] Newly added brokers: , deleted brokers: 0, bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 19:16:04,051] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:16:04,052] WARN [RequestSendThread controllerId=1] Controller 1 epoch 7 fails to send request (type=StopReplicaRequest, controllerId=1, controllerEpoch=7, brokerEpoch=859, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=9, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:16:04,052] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 19:16:04,052] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:16:04,052] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:16:04,054] INFO [Controller id=1] Broker failure callback for 0 (kafka.controller.KafkaController)
[2025-01-18 19:16:04,054] INFO [Controller id=1] Removed 0 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 19:16:04,082] DEBUG [Controller id=1] Unregister BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 19:16:04,082] INFO [Controller id=1] Updated broker epochs cache: HashMap(1 -> 783, 2 -> 914) (kafka.controller.KafkaController)
[2025-01-18 19:19:06,655] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:19:06,697] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2025-01-18 19:19:06,702] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2025-01-18 19:19:06,750] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 19:19:06,757] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 19:19:06,761] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 19:19:06,765] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 19:19:06,788] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2025-01-18 19:19:06,797] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2025-01-18 19:19:06,808] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:19:06,819] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:19:06,821] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2025-01-18 19:19:06,821] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 19:19:06,822] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 19:19:06,822] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 19:19:06,827] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 19:19:06,827] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2025-01-18 19:19:06,827] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 19:19:06,828] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2025-01-18 19:19:06,830] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 19:19:06,851] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:19:06,853] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:19:06,861] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:19:06,862] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:19:06,862] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:19:06,863] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:19:06,873] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:19:06,873] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2025-01-18 19:19:06,874] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:19:06,888] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:19:06,889] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:19:06,890] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 19:19:06,891] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 19:19:06,895] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 19:19:06,940] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 19:19:06,989] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:19:11,711] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 19:19:11,712] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:19:11,720] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:19:11,721] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 19:19:11,728] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:19:11,729] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 19:19:11,732] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45) (kafka.controller.KafkaController)
[2025-01-18 19:19:11,780] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:19:11,809] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:19:11,839] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:19:11,942] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:19:11,943] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:19:11,956] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:19:12,077] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:19:12,191] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:19:13,827] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:19:13,828] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:19:13,834] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:19:13,834] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 19:19:13,836] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 19:19:13,838] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 19:19:13,839] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:19:13,898] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:19:13,929] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:19:13,957] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:19:14,066] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:19:14,177] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:19:35,042] INFO [Controller id=0] New topics: [Set(kafka-chat)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(kafka-chat,Some(nSnt8nt4S-eEPssYOJ862Q),Map(kafka-chat-0 -> ReplicaAssignment(replicas=1,0, addingReplicas=, removingReplicas=), kafka-chat-1 -> ReplicaAssignment(replicas=0,2, addingReplicas=, removingReplicas=), kafka-chat-2 -> ReplicaAssignment(replicas=2,1, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-18 19:19:35,043] INFO [Controller id=0] New partition creation callback for kafka-chat-0,kafka-chat-1,kafka-chat-2 (kafka.controller.KafkaController)
[2025-01-18 19:20:47,033] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 19:20:47,033] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 19:20:47,033] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 19:20:47,081] TRACE [Controller id=0] All leaders = kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),kafka-chat-2 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2025-01-18 19:20:47,105] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=25, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:47,226] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:47,268] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:20:47,268] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:20:47,268] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:20:47,269] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 19:20:47,269] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 19:20:47,270] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:20:47,272] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:20:47,273] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,273] WARN [RequestSendThread controllerId=0] Controller 0 epoch 1 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=1, brokerEpoch=25, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='kafka-chat', partitionStates=[StopReplicaPartitionState(partitionIndex=0, leaderEpoch=0, deletePartition=false)])) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:47,275] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,275] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,275] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,276] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,277] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,277] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,278] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,278] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,278] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,280] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 19:20:47,313] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2025-01-18 19:20:47,316] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 19:20:47,320] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 19:20:47,323] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 19:20:47,321] DEBUG [Controller id=1] Broker 2 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-18 19:20:47,326] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 19:20:47,333] INFO [Controller id=2] Initialized broker epochs cache: HashMap(1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 19:20:47,350] DEBUG [Controller id=2] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 19:20:47,364] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:20:47,375] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:20:47,381] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,381] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,383] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 19:20:47,383] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 19:20:47,384] INFO [Controller id=2] Current list of topics in the cluster: HashSet(kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 19:20:47,384] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 19:20:47,389] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 19:20:47,390] INFO [Controller id=2] List of topics ineligible for deletion: kafka-chat (kafka.controller.KafkaController)
[2025-01-18 19:20:47,390] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 19:20:47,391] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 19:20:47,392] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 19:20:47,402] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,402] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:20:47,403] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:20:47,410] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:20:47,436] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:20:47,465] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=kafka-chat,Partition=1,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:20:47,466] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:20:47,469] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:20:47,471] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(kafka-chat-0 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, kafka-chat-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:20:47,472] INFO [Controller id=2] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2025-01-18 19:20:47,480] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:20:47,481] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:20:47,481] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 19:20:47,481] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 19:20:47,483] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 19:20:47,499] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 19:20:52,513] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:20:52,513] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:20:52,515] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 Map(kafka-chat-1 -> List(0, 2)) (kafka.controller.KafkaController)
[2025-01-18 19:20:52,516] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 19:20:52,518] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 19:20:52,518] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2025-01-18 19:20:52,518] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:20:52,518] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2025-01-18 19:20:52,518] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:20:55,888] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:20:55,889] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:20:55,894] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:20:55,895] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-18 19:20:55,901] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 19:20:55,903] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:55,903] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 93, 1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 19:20:55,942] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:20:55,963] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:20:56,011] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:56,118] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:56,224] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:20:56,461] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 19:20:56,468] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=2, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-18 19:20:56,478] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 19:20:56,481] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-18 19:20:57,730] INFO [Controller id=2] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 19:20:57,730] DEBUG [Controller id=2] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 19:20:57,731] DEBUG [Controller id=2] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 19:20:57,762] TRACE [Controller id=2] All leaders = kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:2),kafka-chat-1 -> (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:2,ControllerEpoch:2),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-18 19:20:57,790] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type: UpdateMetadataRequest=, controllerId=2, controllerEpoch=2, kraftController=false, type=UNKNOWN, brokerEpoch=45, partitionStates=[UpdateMetadataPartitionState(topicName='kafka-chat', partitionIndex=2, controllerEpoch=2, leader=2, leaderEpoch=1, isr=[2], zkVersion=1, replicas=[2, 1], offlineReplicas=[1])], liveBrokers=UpdateMetadataBroker(id=2, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9094, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:259)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:57,897] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:57,961] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:20:57,962] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:20:57,962] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:20:57,962] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 19:20:57,963] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 19:20:57,964] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:20:57,965] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:20:57,966] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 19:20:57,978] INFO [Controller id=2] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 19:20:57,979] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:20:57,979] WARN [RequestSendThread controllerId=2] Controller 2 epoch 2 fails to send request (type: UpdateMetadataRequest=, controllerId=2, controllerEpoch=2, kraftController=false, type=UNKNOWN, brokerEpoch=45, partitionStates=[UpdateMetadataPartitionState(topicName='kafka-chat', partitionIndex=2, controllerEpoch=2, leader=2, leaderEpoch=1, isr=[2], zkVersion=1, replicas=[2, 1], offlineReplicas=[1])], liveBrokers=UpdateMetadataBroker(id=2, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9094, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1133)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at org.apache.kafka.server.util.ShutdownableThread.pause(ShutdownableThread.java:122)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:240)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:20:57,981] TRACE [RequestSendThread controllerId=2] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2025-01-18 19:20:57,981] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:20:57,981] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:20:57,984] INFO [Controller id=2] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-18 19:20:57,985] INFO [Controller id=2] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 19:20:57,992] DEBUG [Controller id=2] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 19:20:57,993] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 93, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 19:21:06,495] INFO [Controller id=2] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:21:06,496] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:21:06,501] INFO [Controller id=2] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 19:21:06,501] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:21:06,503] DEBUG [Controller id=2] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 19:21:06,506] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:21:06,506] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 93, 1 -> 114, 2 -> 61) (kafka.controller.KafkaController)
[2025-01-18 19:21:06,554] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:21:06,571] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:21:06,616] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:21:06,725] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:21:06,830] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:21:07,033] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 19:21:07,035] DEBUG [Controller id=2] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2). (kafka.controller.KafkaController)
[2025-01-18 19:21:07,048] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 19:21:07,050] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=0, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-18 19:21:08,821] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2025-01-18 19:21:08,821] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2025-01-18 19:21:08,821] DEBUG [Controller id=2] Live brokers: 0,1 (kafka.controller.KafkaController)
[2025-01-18 19:21:08,827] TRACE [Controller id=2] All leaders = kafka-chat-0 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:4,ControllerEpoch:2),kafka-chat-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:2),kafka-chat-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:3,ControllerEpoch:2) (kafka.controller.KafkaController)
[2025-01-18 19:21:08,982] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:21:08,983] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:21:08,983] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:21:08,983] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2025-01-18 19:21:08,983] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 19:21:08,984] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:21:08,984] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:21:08,985] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,985] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,985] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,987] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,987] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,987] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,988] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,988] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,988] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:21:08,990] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2025-01-18 19:21:09,017] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 3 and epoch zk version is now 3 (kafka.controller.KafkaController)
[2025-01-18 19:21:09,022] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 19:21:09,026] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 19:21:09,026] DEBUG [Controller id=1] Broker 0 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-18 19:21:09,029] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 19:21:09,062] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 19:21:09,072] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 93, 1 -> 114) (kafka.controller.KafkaController)
[2025-01-18 19:21:09,087] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0, 1) (kafka.controller.KafkaController)
[2025-01-18 19:21:09,101] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:21:09,114] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:21:09,121] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:21:09,121] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:21:09,123] INFO [Controller id=0] Currently active brokers in the cluster: Set(0, 1) (kafka.controller.KafkaController)
[2025-01-18 19:21:09,124] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 19:21:09,124] INFO [Controller id=0] Current list of topics in the cluster: HashSet(kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 19:21:09,124] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 19:21:09,131] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 19:21:09,131] INFO [Controller id=0] List of topics ineligible for deletion: kafka-chat (kafka.controller.KafkaController)
[2025-01-18 19:21:09,132] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 19:21:09,132] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 19:21:09,133] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 19:21:09,146] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:21:09,146] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:21:09,146] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:21:09,155] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:21:09,176] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:21:09,201] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=kafka-chat,Partition=1,Replica=0] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:21:09,202] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:21:09,208] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:21:09,210] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(kafka-chat-0 -> OnlinePartition, kafka-chat-1 -> OnlinePartition, kafka-chat-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:21:09,211] INFO [Controller id=0] Ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2025-01-18 19:21:09,216] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:21:09,217] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:21:09,217] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 19:21:09,217] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 19:21:09,219] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 19:21:09,231] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 19:21:14,245] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:21:14,245] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:21:14,247] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2025-01-18 19:21:14,248] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:21:14,249] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map(kafka-chat-0 -> List(1, 0)) (kafka.controller.KafkaController)
[2025-01-18 19:21:14,249] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 19:21:14,250] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions kafka-chat-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 19:21:14,266] INFO [Controller id=0] Partition kafka-chat-0 completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2025-01-18 19:21:14,266] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(kafka-chat-2 -> List(2, 1)) (kafka.controller.KafkaController)
[2025-01-18 19:21:14,266] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 19:21:14,266] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 19:22:05,868] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:22:05,868] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:22:05,879] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:22:05,881] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2025-01-18 19:22:05,886] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:22:05,888] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2025-01-18 19:22:05,889] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 93, 1 -> 114, 2 -> 139) (kafka.controller.KafkaController)
[2025-01-18 19:22:05,926] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:22:05,941] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:22:06,001] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:22:06,109] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:22:06,214] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:22:06,440] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 19:22:06,447] DEBUG [Controller id=0] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=0, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-18 19:22:06,455] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 19:22:06,458] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=1, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=4). (kafka.controller.KafkaController)
[2025-01-18 19:22:23,149] INFO [Controller id=0] New topics: [Set(__consumer_offsets)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(__consumer_offsets,Some(epjp_PeAR5Ceq-_QnaVQ5w),HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2025-01-18 19:22:23,151] INFO [Controller id=0] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2025-01-18 19:22:59,716] DEBUG [Controller id=0] There is no producerId block yet (Zk path version 0), creating the first block (kafka.controller.KafkaController)
[2025-01-18 19:22:59,722] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000) by writing to Zk with path version 1 (kafka.controller.KafkaController)
[2025-01-18 19:22:59,836] DEBUG [Controller id=0] Read current producerId block ProducerIdsBlock(assignedBrokerId=0, firstProducerId=0, size=1000), Zk path version 1 (kafka.controller.KafkaController)
[2025-01-18 19:22:59,840] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=1, firstProducerId=1000, size=1000) by writing to Zk with path version 2 (kafka.controller.KafkaController)
[2025-01-18 19:23:06,690] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2025-01-18 19:23:06,690] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2025-01-18 19:23:06,691] DEBUG [Controller id=0] Live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 19:23:06,709] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),kafka-chat-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),kafka-chat-1 -> (Leader:0,ISR:0,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:4,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),kafka-chat-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3) (kafka.controller.KafkaController)
[2025-01-18 19:23:06,973] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:23:06,974] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:23:06,974] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:23:06,974] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2025-01-18 19:23:06,974] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2025-01-18 19:23:06,975] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:23:06,976] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:23:06,977] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2025-01-18 19:23:06,988] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2025-01-18 19:23:06,988] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:23:06,989] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:23:06,989] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:23:06,992] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2025-01-18 19:23:06,993] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2025-01-18 19:23:07,039] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 19:23:07,040] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 93, 2 -> 139) (kafka.controller.KafkaController)
[2025-01-18 19:23:21,655] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:23:21,655] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:23:21,658] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:23:21,658] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2025-01-18 19:23:21,662] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:23:21,680] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2025-01-18 19:23:21,681] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 93, 1 -> 282, 2 -> 139) (kafka.controller.KafkaController)
[2025-01-18 19:23:21,708] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:23:21,726] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:23:21,766] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:23:21,875] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:23:21,982] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:23:22,228] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 19:23:22,231] DEBUG [Controller id=0] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=0, leaderEpoch=4, isrWithBrokerEpoch=List(BrokerState(brokerId=0, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=7). (kafka.controller.KafkaController)
[2025-01-18 19:23:22,291] DEBUG [Controller id=0] Updating ISRs for partitions: Set(kafka-chat-2). (kafka.controller.KafkaController)
[2025-01-18 19:23:22,294] DEBUG [Controller id=0] ISR for partition kafka-chat-2 updated to LeaderAndIsr(leader=2, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6). (kafka.controller.KafkaController)
[2025-01-18 19:23:23,910] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2025-01-18 19:23:23,910] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2025-01-18 19:23:23,910] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2025-01-18 19:23:23,916] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-46 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-17 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-26 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-5 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-38 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),kafka-chat-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:8,ControllerEpoch:3),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-41 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-20 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-49 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-29 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-25 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-37 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-4 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),kafka-chat-1 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:3),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-11 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-44 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-23 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-19 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-28 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-7 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-40 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),kafka-chat-2 -> (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:6,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-14 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-43 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-31 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:3),__consumer_offsets-35 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3),__consumer_offsets-2 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:3) (kafka.controller.KafkaController)
[2025-01-18 19:23:24,196] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:23:24,196] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:23:24,196] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:23:24,197] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2025-01-18 19:23:24,197] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2025-01-18 19:23:24,197] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:23:24,198] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:23:24,198] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,198] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,198] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,200] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,200] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,200] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,201] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,201] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,201] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,203] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2025-01-18 19:23:24,225] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 4 and epoch zk version is now 4 (kafka.controller.KafkaController)
[2025-01-18 19:23:24,226] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2025-01-18 19:23:24,230] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2025-01-18 19:23:24,233] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2025-01-18 19:23:24,236] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2025-01-18 19:23:24,239] DEBUG [Controller id=1] Broker 2 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2025-01-18 19:23:24,243] INFO [Controller id=2] Initialized broker epochs cache: HashMap(1 -> 282, 2 -> 139) (kafka.controller.KafkaController)
[2025-01-18 19:23:24,263] DEBUG [Controller id=2] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 19:23:24,292] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:23:24,302] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:23:24,308] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,308] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,308] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2025-01-18 19:23:24,308] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2025-01-18 19:23:24,309] INFO [Controller id=2] Current list of topics in the cluster: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.KafkaController)
[2025-01-18 19:23:24,309] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2025-01-18 19:23:24,314] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2025-01-18 19:23:24,314] INFO [Controller id=2] List of topics ineligible for deletion: __consumer_offsets,kafka-chat (kafka.controller.KafkaController)
[2025-01-18 19:23:24,315] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2025-01-18 19:23:24,315] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(__consumer_offsets, kafka-chat) (kafka.controller.TopicDeletionManager)
[2025-01-18 19:23:24,316] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2025-01-18 19:23:24,326] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,326] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:23:24,327] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:23:24,336] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:23:24,362] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:23:24,412] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=34,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=40,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=1] -> OnlineReplica, [Topic=kafka-chat,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=2,Replica=2] -> OnlineReplica, [Topic=kafka-chat,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OfflineReplica, [Topic=kafka-chat,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=1] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2025-01-18 19:23:24,413] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:23:24,417] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:23:24,453] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OfflinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, kafka-chat-0 -> OnlinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OfflinePartition, kafka-chat-1 -> OnlinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, kafka-chat-2 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OfflinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2025-01-18 19:23:24,453] INFO [Controller id=2] Ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2025-01-18 19:23:24,458] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:23:24,458] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2025-01-18 19:23:24,458] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2025-01-18 19:23:24,458] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2025-01-18 19:23:24,460] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2025-01-18 19:23:24,469] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2025-01-18 19:23:29,474] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:23:29,474] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:23:29,478] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-33 -> List(0), kafka-chat-1 -> List(0, 2), __consumer_offsets-36 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0)) (kafka.controller.KafkaController)
[2025-01-18 19:23:29,479] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2025-01-18 19:23:29,480] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2025-01-18 19:23:29,480] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-18 19:23:29,480] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:23:29,480] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 19:23:29,480] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:23:38,433] INFO [Controller id=2] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2025-01-18 19:23:38,433] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2025-01-18 19:23:38,438] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2025-01-18 19:23:38,439] INFO [Controller id=2] New broker startup callback for 0 (kafka.controller.KafkaController)
[2025-01-18 19:23:38,445] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:23:38,473] DEBUG [Controller id=2] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2025-01-18 19:23:38,475] INFO [Controller id=2] Updated broker epochs cache: HashMap(0 -> 339, 1 -> 282, 2 -> 139) (kafka.controller.KafkaController)
[2025-01-18 19:23:38,495] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2025-01-18 19:23:38,513] DEBUG [Controller id=0] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2025-01-18 19:23:38,558] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:23:38,666] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:23:38,779] WARN [RequestSendThread controllerId=2] Controller 2's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:299)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2025-01-18 19:23:38,883] INFO [RequestSendThread controllerId=2] Controller 2 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2025-01-18 19:23:39,211] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-1). (kafka.controller.KafkaController)
[2025-01-18 19:23:39,216] DEBUG [Controller id=2] ISR for partition kafka-chat-1 updated to LeaderAndIsr(leader=2, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6). (kafka.controller.KafkaController)
[2025-01-18 19:23:39,226] DEBUG [Controller id=2] Updating ISRs for partitions: Set(kafka-chat-0). (kafka.controller.KafkaController)
[2025-01-18 19:23:39,230] DEBUG [Controller id=2] ISR for partition kafka-chat-0 updated to LeaderAndIsr(leader=1, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=0, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=9). (kafka.controller.KafkaController)
[2025-01-18 19:28:29,491] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2025-01-18 19:28:29,491] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2025-01-18 19:28:29,492] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(kafka-chat-1 -> List(0, 2)) (kafka.controller.KafkaController)
[2025-01-18 19:28:29,492] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2025-01-18 19:28:29,492] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2025-01-18 19:28:29,492] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2025-01-18 19:28:29,492] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2025-01-18 19:28:29,492] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
